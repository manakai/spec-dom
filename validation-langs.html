<!DOCTYPE html><html class="formal-specification anolis" lang=en><head>
<title>DOM Tree Validation</title>
<meta charset=utf-8>
<link href=spec.css rel=stylesheet>
<link href=#license rel=license>
</head>
<body class=has-abstract>

<header>

<hgroup>
  <h1 class="no-toc no-num">DOM Tree Validation</h1>
  <h2 class="no-toc no-num">The manakai project, 21 April 2018</h2>
</hgroup>

<dl class=versions-uri>

<div>
<dt>Latest version
</dt><dd><a href=https://manakai.github.io/spec-dom/validation-langs>https://manakai.github.io/spec-dom/validation-langs</a>
</dd></div>

<div id=version-history>
<dt>Version history
</dt><dd><a href=https://github.com/manakai/spec-dom/commits/gh-pages/validation-langs-source.en.html>https://github.com/manakai/spec-dom/commits/gh-pages/validation-langs-source.en.html</a>
</dd></div>

</dl>

</header>

<section id=status>
<h1 class="no-toc no-num" id=status-of-this-document>Status of This Document</h1>

<p>This document is
a <a href=https://manakai.github.io/docs#specs>technical
specification</a> produced as part
of <a href=https://manakai.github.io/>the manakai project</a>.  It
might be updated, replaced, or obsoleted by other documents at any
time.

</p><p>The scope of this specification is limited to the products
within <a href=https://manakai.github.io/>the manakai project</a>.
It does not intended to be implemented by multiple parties, although
nothing prevents it from implemented by other DOM implementations.

</p><p>Comments on this document are welcome and may be sent to
the <a href=#author>author</a>.</p>

</section>

<section>
<h1 class="no-toc no-num" id=table-of-contents>Table of contents</h1>

<!--begin-toc-->
<ol class=toc>
 <li><a href=#introduction><span class=secno>1 </span>Introduction</a>
  <ol>
   <li><a href=#scope><span class=secno>1.1 </span>Scope</a></li>
   <li><a href=#history-0><span class=secno>1.2 </span>History</a></li></ol></li>
 <li><a href=#infrastructure><span class=secno>2 </span>Infrastructure</a></li>
 <li><a href=#validation-modes><span class=secno>3 </span>Validation modes</a></li>
 <li><a href=#validation-of-unknown-namespaces><span class=secno>4 </span>Validation of unknown namespaces</a></li>
 <li><a href=#validation-of-rdf/xml-fragments><span class=secno>5 </span>Validation of RDF/XML fragments</a>
  <ol>
   <li><a href="#integration-with-rdf/xml's-data-model"><span class=secno>5.1 </span>Integration with RDF/XML's data model</a></li></ol></li>
 <li><a href=#rss-elements><span class=secno>6 </span>RSS elements</a></li>
 <li><a href=#atom-elements><span class=secno>7 </span>Atom elements</a></li>
 <li><a href=#ogp><span class=secno>8 </span>OGP</a></li>
 <li><a href=#document-element><span class=secno>9 </span>Document element</a></li>
 <li><a href=#checking-an-element><span class=secno>10 </span>Checking an element</a></li>
 <li><a href=#data><span class=secno>11 </span>Data</a></li>
 <li><a class=no-num href=#references>References</a></li>
 <li><a class=no-num href=#author>Author</a></li></ol>
<!--end-toc-->
</section>

<section>
<h1 id=introduction><span class=secno>1 </span>Introduction</h1>

<p class=section-info><em>This section is non-normative.</em>

</p><p>This specification defines details of DOM tree validation not
covered by other <a href=#applicable-specification title="applicable specification">applicable
specifications</a>.

</p><section>
<h1 id=scope><span class=secno>1.1 </span>Scope</h1>

<p>This specification defines:

</p><ul>

<li>how to choose the set of requirements used
for <span title=validate>validation</span> of a <a href=#node>node</a> when
there are multiple candidate specifications,
and

</li><li>how <a href=#element title=element>elements</a>
and <a href=#attribute title=attribute>attributes</a> <a href=#in-no-namespace>in no
namespace</a> and in <a href=#unknown-namespace title="unknown namespace">unknown
namespaces</a> are <span title=validate>validated</span>,

</li></ul>

... for <span>validator</span> implementations
by <a href=https://manakai.github.io/>the manakai project</a>.

</section>

<section id=history>
  <h1 id=history-0><span class=secno>1.2 </span>History</h1>

  <p>This specification was originally published
  at <code class=URI>&lt;<a href=http://suika.suikawiki.org/www/markup/xml/validation-langs>http://suika.suikawiki.org/www/markup/xml/validation-langs</a>&gt;</code>
  as <cite>Handling of unknown namespaces in conformance
  checking</cite> since <time datetime=2013-12>December,
  2013</time>.  <!-- and its history was at
  <http://suika.suikawiki.org/gate/git/wi/markup/xmlexts.git/history/HEAD:/validation-langs-source.en.html>
  -->

  </p><p>Earlier versions of this specification contained non-normative
  descriptions of how to <span>validate</span>
  HTML <code id=checking-an-html-script-element>script</code>
  and <code id=checking-an-html-style-element>style</code> <a href=#element title=element>elements</a>.
  As definitions of these <a href=#element title=element>elements</a> were
  slightly simplified in the
  <a href=https://html.spec.whatwg.org><cite>HTML Standard</cite></a>,
  these descriptions were removed.

</p></section>

</section>

<section>
<h1 id=infrastructure><span class=secno>2 </span>Infrastructure</h1>

<p>This specification depends on the
<a href=https://infra.spec.whatwg.org/><cite>Infra
Standard</cite></a>.  The terms

<dfn id=list>list</dfn>,
<dfn id=code-point>code point</dfn>,
<dfn id=concatenate>concatenate</dfn>,
<dfn id=html-namespace>HTML namespace</dfn>,
and
<dfn id=xmlns-namespace>XMLNS namespace</dfn>

are defined by the <a href=https://infra.spec.whatwg.org/><cite>Infra
Standard</cite></a>.

</p><p>For the purpose of this specification, <dfn id=user-agent title="user agent">user
agents</dfn> are <span title="conformance checker">conformance
checkers</span>, also known
as <span title=validator>validators</span>.

</p><p><a href=#user-agent title="user agent">User agents</a>
<em class=rfc2119>MUST</em> implement
the <a href=https://dom.spec.whatwg.org/><cite>DOM
Standard</cite></a>.  Terms

<dfn id=child>child</dfn>, 
<dfn id=parent>parent</dfn>,
<dfn id=ancestor>ancestor</dfn>,
<dfn id=node>node</dfn>,
<dfn id=node-document>node document</dfn>,
<dfn id=document>document</dfn>,
<dfn id=concept-document-content-type title=concept-document-content-type>content
type</dfn>, <dfn id=html-document>HTML document</dfn>, <dfn id=xhtml-document>XHTML
document</dfn>, <dfn id=document-element-0>document
element</dfn>, 
<dfn id=element>element</dfn>,
<dfn id=attribute-list>attribute list</dfn>,
<dfn id=attribute>attribute</dfn>,
<dfn id=attribute-value title="attribute value">value</dfn>,
<dfn id=namespace>namespace</dfn> (of <a href=#element>element</a> or <a href=#attribute>attribute</a>),
<dfn id=local-name>local name</dfn> (of <a href=#element>element</a> or <a href=#attribute>attribute</a>),
<dfn id=comment>comment</dfn> (<dfn id=dom-comment title=dom-Comment><code>Comment</code></dfn>),
<dfn id=processing-instruction>processing instruction</dfn> (<dfn id=processinginstruction><code>ProcessingInstruction</code></dfn>),
<dfn id=template-content>template content</dfn>,
and
<dfn id=shadow-tree>shadow tree</dfn>

are defined by the <a href=https://dom.spec.whatwg.org/><cite>DOM
Standard</cite></a>.

</p><p><a href=#user-agent title="user agent">User
agents</a> <em class=rfc2119>MUST</em> implement the
<a href=https://html.spec.whatwg.org><cite>HTML Standard</cite></a>.
Terms

<dfn id=applicable-specification>applicable specification</dfn>,
<dfn id=document-base-url>document base URL</dfn>,
<dfn id=inter-element-whitespace>inter-element whitespace</dfn>,
and
<dfn id=valid-e-mail-address>valid e-mail address</dfn>

are defined by the <a href=https://html.spec.whatwg.org><cite>HTML
Standard</cite></a>.


</p><p>User agents <em class=rfc2119>MUST</em> support
XML <cite class="bibref normative">[<a href=#ref-XML>XML</a>]</cite>
and XML Namespaces
<cite class="bibref normative">[<a href=#ref-XMLNS>XMLNS</a>]</cite>.

</p><p>The terms 

<dfn id=information-item>information item</dfn>,
<dfn id=document-information-item>document information item</dfn>,
<dfn id=element-information-item>element information item</dfn>,
<dfn id=attribute-information-item>attribute information item</dfn>,
<dfn id=character-information-item>character information item</dfn>,
<dfn id=children>[children]</dfn>,
<dfn id=parent-0>[parent]</dfn>,
<dfn id=attributes>[attributes]</dfn>,
<dfn id=document-element-1>[document element]</dfn>,
<dfn id=base-uri>[base URI]</dfn>,
<dfn id=normalized-value>[normalized value]</dfn>,
<dfn id=character-code>[character code]</dfn>,
<dfn id=namespace-name>[namespace name]</dfn>,
and
<dfn id=local-name-0>[local name]</dfn>,

are defined by the
<a href=https://www.w3.org/TR/xml-infoset/><cite>XML Information
Set</cite></a> specification.


</p><p>User agents are not required to implement other specifications, but
are expected to follow steps defined in this specification.  For
example, a user agent might not support XSLT, but is is still required
to detect whether an element is interpreted per XSLT specifications or
not as defined by this specification.

</p><hr>

<p>The terms <dfn id=valid-url>valid URL</dfn> and <dfn id=valid-absolute-url>valid absolute URL</dfn>
are defined by <a href=http://url.spec.whatwg.org/>URL Standard</a>
as <i>URL</i> and <i>absolute URL</i>, respectively.

</p><p>The term <dfn id=valid-mime-type>valid MIME type</dfn> is defined by <a href=http://mimesniff.spec.whatwg.org/>MIME Sniffing Standard</a> as
<i>parsable MIME type</i>.

The <dfn id=utf-8><code>utf-8</code></dfn> character encoding is defined by <a href=http://encoding.spec.whatwg.org/>Encoding Standard</a>.

</p><p>The term <dfn id=valid-language-tag>valid language tag</dfn> is defined by <a href=http://tools.ietf.org/html/bcp47>BCP 47</a>.

</p><p>The term <dfn id=date-construct>Date construct</dfn> is defined by <a href=http://tools.ietf.org/html/rfc4287>Atom 1.0 specification</a>.

</p><p>The term

<a href=https://www.w3.org/TR/1999/REC-xslt-19991116#literal-result-element><dfn id=literal-result-element>literal result element</dfn></a>

is defined by the
<a href=https://www.w3.org/TR/1999/REC-xslt-19991116>XSLT1
specification</a>.

The <dfn id=xslt-namespace>XSLT namespace</dfn> is
<code>http://www.w3.org/1999/XSL/Transform</code>.

</p><p><a href=#user-agent title="user agent">User
agents</a> <em class=rfc2119>MUST</em> implement the <a href=#rdf/xml-specification>RDF/XML
specification</a>.  The <dfn id=rdf/xml-specification>RDF/XML specification</dfn> is
<a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html><cite>RDF
1.1 XML Syntax</cite></a>.  The terms

<a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html#section-Syntax-property-attributes><dfn id=string-literal>string literal</dfn></a>,
<a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html#section-Syntax-XML-literals><dfn id=xml-literal>XML literal</dfn></a>,
and
<a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html#section-Infoset-Conformance><dfn id=transform-the-infoset-into-the-sequence-of-events-in-document-order>transform the Infoset into the sequence of events in <i>document order</i></dfn></a>

are defined by the <a href=#rdf/xml-specification>RDF/XML specification</a>.  The term

<a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-concepts/index.html#dfn-rdf-graph><dfn id=rdf-graph>RDF graph</dfn></a>

is defined by the
<a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-concepts/index.html><cite>RDF
1.1 Concepts and Abstract Syntax</cite></a> specification.
The <dfn id=rdf-namespace>RDF namespace</dfn>
is <code>http://www.w3.org/1999/02/22-rdf-syntax-ns#</code>.




</p><p>The <dfn id=rss1-namespace>RSS1 namespace</dfn> is
<code>http://purl.org/rss/1.0/</code>.

</p><hr>

<p>When a value is required to match the production labeled
<code title="">document</code> in the XML
specification<!-- <iframe srcdoc=""> in XML [HTML] -->,
it <em class=rfc2119>MUST</em> also conform to other requirements for
XML documents.

</p></section>

<section>
<h1 id=validation-modes><span class=secno>3 </span>Validation modes</h1>

<p>A <dfn id=validation-mode>validation mode</dfn> identify the specifications that
describe the requirements used to <span>validate</span>
a <a href=#node>node</a>.  There are five <a href=#validation-mode title="validation
mode">modes</a>:

</p><dl class=switch>

<dt><dfn id=default-mode>Default mode</dfn>
</dt><dd>Conformance of the <a href=#node>node</a> is governed by its definition
in the <a href=#native-element-specifications>native element specifications</a> or the <span>RSS2
specifications</span>, or by the rules for the <a href=#unknown-namespace-element title="unknown
namespace element">unknown namespace elements</a>
and <a href=#unknown-namespace-attribute title="unknown namespace attribute">attributes</a>.

The <dfn id=native-element-specifications>native element specifications</dfn> are
the <a href=#applicable-specification title="applicable specification">applicable
specifications</a> such as
<a href=https://html.spec.whatwg.org><cite>HTML Standard</cite></a>,
except for the <a href=#xslt-specifications>XSLT specifications</a>, the <a href=#rdf/xml-specification>RDF/XML
specification</a>, the <a href=#rss1-specifications>RSS1 specifications</a>,
the <span>RSS2 specifications</span>, and <em>this</em> specification.

</dd><dt><dfn id=xslt-mode>XSLT mode</dfn>
</dt><dd>Conformance of the <a href=#node>node</a> is governed by the <a href=#xslt-specifications>XSLT
specifications</a>.  For the purpose of this specification,
the <dfn id=xslt-specifications>XSLT specifications</dfn> are any <a href=#applicable-specification title="applicable
specification">applicable specifications</a> defining XSLT and its
extensions.

<dfn id=xslt-family-element title="XSLT family element">XSLT family elements</dfn>
are <span>elements</span> in the <a href=#xslt-namespace>XSLT namespace</a> and
XSLT <span title="extension namespace">extension namespaces</span>
defined by <a href=#xslt-specifications>XSLT specifications</a>.  Note that
XSLT <a href=#literal-result-element title="literal result element">literal result
elements</a> are not <a href=#xslt-family-element title="XSLT family element">XSLT family
elements</a>.

</dd><dt><dfn id=rdf-mode>RDF mode</dfn>
</dt><dd>Conformance of the <a href=#node>node</a> is governed by
the <a href=#rdf/xml-specification>RDF/XML specification</a>.

</dd><dt><dfn id=rss1-mode>RSS1 mode</dfn>
</dt><dd>Conformance of the <a href=#node>node</a> is governed by both
the <a href=#rdf/xml-specification>RDF/XML specification</a> and the <a href=#rss1-specifications>RSS1
specifications</a>.  For the purpose of this specification,
the <dfn id=rss1-specifications>RSS1 specifications</dfn> are any <a href=#applicable-specification title="applicable
specification">applicable specifications</a> defining RSS1 and its
modules.

</dd></dl>

<p>To <dfn id=determine-the-validation-mode>determine the validation mode</dfn> of
a <a href=#node>node</a> <var>node</var>, run these steps:

</p><ol class=steps>

<li>If <var>node</var> is a <a href=#document-element-0>document element</a>, switch
by <var>node</var>'s <a href=#node-document>node
document</a>'s <a href=#concept-document-content-type title=concept-document-content-type>content
type</a>:

  <dl class=switch>

  <dt><code>application/xml</code> or <code>text/xml</code>

  </dt><dd>If <var>node</var> is a <a href=#literal-result-element>literal result element</a>
  and <var>node</var> has
  the <code>version</code> <a href=#attribute>attribute</a> in the <a href=#xslt-namespace>XSLT
  namespace</a>, return <a href=#xslt-mode>XSLT mode</a> and abort these
  steps.

  </dd><dt><code>application/xslt+xml</code> or <code>text/xsl</code>

  </dt><dd>If <var>node</var> is an <a href=#xslt-family-element>XSLT family element</a> or
  a <a href=#literal-result-element>literal result element</a>, return <a href=#xslt-mode>XSLT mode</a>
  and abort these steps.

  </dd><dt><code>application/rdf+xml</code>

  </dt><dd>Return <a href=#rdf-mode>RDF mode</a> and abort these steps.

  </dd></dl>

</li><li>Let <var>parent</var> be <var>node</var>'s <a href=#parent>parent</a>.

</li><li>Let <var>parent mode</var> be <a href=#default-mode>default mode</a>.

</li><li>If <var>parent</var> is not <code>null</code>, set <var>parent
node</var> to the result of <a href=#determine-the-validation-mode title="determine the validation
mode">determining the validation mode</a> of <var>parent</var>.

</li><li>If <var>parent mode</var> is <a href=#rdf-mode>RDF mode</a> or <a href=#rss1-mode>RSS1
mode</a> and <var>parent</var> is an <a href=#xml-literal>XML literal</a>,
set <var>parent mode</var> to <a href=#default-mode>default mode</a>.

</li><li>If <var>node</var> is an <a href=#xslt-family-element>XSLT family element</a>, or if
<var>parent mode</var> is <a href=#xslt-mode>XSLT mode</a> and <var>node</var> is an
<a href=#literal-result-element>literal result element</a>, return <a href=#xslt-mode>XSLT mode</a> and
abort these steps.

</li><li>If <var>node</var> is an <code>RDF</code> <a href=#element>element</a> in
the <a href=#rdf-namespace>RDF namespace</a>:

  <ol>

  <li>If <var>node</var> has
  the <code>xmlns</code> <a href=#attribute>attribute</a> in the
  <a href=#xmlns-namespace>XMLNS namespace</a> whose <a href=#attribute-value title="attribute
  value">value</a> is the <a href=#rss1-namespace>RSS1 namespace</a> and
  the <code>rdf</code> <a href=#attribute>attribute</a> in the
  <a href=#xmlns-namespace>XMLNS namespace</a> whose <a href=#attribute-value title="attribute
  value">value</a> is the <a href=#rdf-namespace>RDF namespace</a>,
  return <a href=#rss1-mode>RSS1 mode</a> and abort these steps.

  </li><li>Otherwise, return <a href=#rdf-mode>RDF mode</a> and abort these steps.

  </li></ol>

</li><li>If <var>parent mode</var> is <a href=#rdf-mode>RDF mode</a> or <a href=#rss1-mode>RSS1
mode</a> and <var>node</var> is considered as matching to a part of
the current production in the
<a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html#section-Data-Model>RDF/XML
Syntax Data Model</a>, return
<var>parent mode</var> and abort these steps.

</li><li>Return <a href=#default-mode>default mode</a>.

</li></ol>

<div class="note memo">

<p><a href=#element title=element>Elements</a> not conforming to the <a href=#rdf/xml-specification>RDF/XML specification</a> (e.g. an
<a href=#element>element</a> in <a href=#string-literal>string literal</a>) are
<span title=validate</span>validated</span> in <a href=#default-mode>default
mode</a>.

</p></div>

</section>


<section>
<h1 id=validation-of-unknown-namespaces><span class=secno>4 </span>Validation of unknown namespaces</h1>

<p>An <a href=#element>element</a> or <a href=#attribute>attribute</a> is <dfn id=in-no-namespace>in no
namespace</dfn> <!-- or <dfn>in null namespace</dfn> --> if
its <a href=#namespace>namespace</a> is <code>null</code>.

</p><p>A <a href=#namespace>namespace</a> which is not <code>null</code>
is <dfn id=supported-namespace title="supported namespace">supported</dfn> if it is defined
by a <a href=#native-element-specifications title="native element specifications">native element
specification</a>.

</p><p>A <a href=#namespace>namespace</a> which is not <code>null</code>
is <dfn id=unknown-namespace title="unknown namespace">unknown</dfn> if it is
not <a href=#supported-namespace title="supported namespace">supported</a>.

</p><p>An <a href=#element>element</a> is <dfn id=unknown-namespace-element>unknown namespace element</dfn> if
its <a href=#namespace>namespace</a> is <a href=#unknown-namespace title="unknown
namespace">unknown</a>, or it is <a href=#in-no-namespace>in no namespace</a> and
is not an <a href=#rss2-element>RSS2 element</a>.

</p><p>An <a href=#attribute>attribute</a> is <dfn id=unknown-namespace-attribute>unknown namespace attribute</dfn>
if its <a href=#namespace>namespace</a> is <a href=#unknown-namespace title="unknown
namespace">unknown</a>.<!-- attribute in no namespace is not
unknown namespace attribute -->

</p><hr>

<p>An <a href=#unknown-namespace-element>unknown namespace element</a> or <a href=#unknown-namespace-attribute>unknown
namespace attribute</a> <em class=rfc2119>MUST NOT</em> be used
anywhere except where they are explicitly allowed.<!-- Somewhat
redundant with HTML Standard but still worth clarifying. -->

</p><p>An <a href=#unknown-namespace-element>unknown namespace element</a> <em class=rfc2119>MAY</em> be used as the <a href=#document-element-0>document element</a> or
as an orphan node.  It <em class=rfc2119>MAY</em> also be used where
any kind of <a href=#element>element</a> is allowed.

</p><p>An <a href=#unknown-namespace-element>unknown namespace
element</a> <em class=rfc2119>MAY</em> have
any <a href=#attribute>attribute</a> in no namespace or any
<a href=#unknown-namespace-attribute>unknown namespace attribute</a>.

</p><div class="note memo">

<p>Additionally, any <a href=#attribute>attribute</a> in
a <a href=#supported-namespace>supported namespace</a> might also be specified to an
<a href=#unknown-namespace-element>unknown namespace element</a> as long as it is allowed by an
<a href=#applicable-specification>applicable specification</a>.

</p></div>

<p>An <a href=#unknown-namespace-element>unknown namespace
element</a> <em class=rfc2119>MAY</em> have any kind
of <a href=#child>child</a> (unless otherwise disallowed).

</p><p>An <a href=#unknown-namespace-attribute>unknown namespace attribute</a> <em class=rfc2119>MAY</em> have any value.

</p><p>An attribute in no namespace of an <a href=#unknown-namespace-element>unknown namespace
element</a> <em class=rfc2119>MAY</em> have any value.

</p><p>Conformance checkers <em class=rfc2119>MAY</em> warn any
<a href=#unknown-namespace-element>unknown namespace element</a> or <a href=#unknown-namespace-attribute>unknown namespace
attribute</a> as use of it could be an authoring error.


</p><div class=note>

<p>Conformance checkers are expected to report errors or warnings on
unknown elements and attributes useful for authors.

</p><p>This specification is not intended to override any other
specification's requirements.

</p><p>For a public Web document, non-standard element which is not
defined by any <a href=#applicable-specification>applicable specification</a> ought to be
reported as an error.

</p><div class=example>

<p>In the following example, as the <code>bookmark</code> element in
the <code>http://mybookmark.example/</code> namespace is not defined
<!--as <span>flow content</span>--> by any <a href=#applicable-specification>applicable
specification</a>, this fragment is non-conforming:

</p><pre class=XML><code>&lt;div xmlns="http://www.w3.org/1999/xhtml"&gt;
  &lt;bookmark xmlns="http://mybookmark.example/"&gt;Hello&lt;/bookmark&gt;
&lt;/div&gt;</code></pre>

</div>

<p>For XML data that is not expected to be directly shown to user
(e.g. an XML data retrieved via <code>XMLHttpRequest</code>), use of
null- or non-standard namespaces ought not to be an error.

</p><div class=example>

<p>For example, following document fragment should not be considered
as non-conforming, nevertheless none of <code>data</code> and
<code>item</code> elements and the <code>name</code> attribute is
defined by any public standard:

</p><pre class=XML><code>&lt;data&gt;
  &lt;item name="x1"/&gt;
  &lt;item name="x2"&gt;&lt;p xmlns="http://www.w3.org/1999/xhtml"&gt;Hi!&lt;/p&gt;&lt;/item&gt;
&lt;/data&gt;</code></pre>

<p>If the <code>p</code> element contained an <code>item</code>
element in no namespace, it ought to be reported as an error, as no
standard defines the <code>item</code> element in no namespace as
<span>phrasing content</span>.

</p></div>

<div class=example>

<p>If there is an element in the
<code>http://www.w3.org/2000/svg<mark>/</mark></code> namespace, an
error or warning ought to be reported.  It is likely an authoring
error.

</p></div>

</div>

</section>

<section>
<h1 id=validation-of-rdf/xml-fragments><span class=secno>5 </span>Validation of RDF/XML fragments</h1>

<section>
<h1 id="integration-with-rdf/xml's-data-model"><span class=secno>5.1 </span>Integration with RDF/XML's data model</h1>

<!-- XXX need to define how to use these steps -->
<p>To <dfn id=parse-a-node-as-rdf/xml>parse a node as RDF/XML</dfn>, where <var>node</var> is
a <a href=#document>document</a> or <a href=#element>element</a>, run these steps:

</p><ol class=steps>

  <li>Let <var>non-RDF nodes</var> be an empty <a href=#list>list</a>.

  </li><li>Repeat:

    <ol>

      <li><p>If <var>node</var> is in <var>non-RDF node</var>, break.

      </p></li><li>

        <p>Let <var>infoset</var> be the result of
        mapping <var>node</var> into an Infoset.

        </p><p>A <a href=#document>document</a> is a mapped to a <a href=#document-information-item>document
        information item</a> whose <a href=#children>[children]</a> is
        the <a href=#mapped-children>mapped children</a> of the <a href=#document>document</a>
        and <a href=#base-uri>[base URI]</a> is
        the <a href=#document>document</a>'s <a href=#document-base-url>document base URL</a>.
        The <a href=#document-information-item>document information item</a>'s <a href=#document-element-1>[document
        element]</a> is the first <a href=#element-information-item>element information
        item</a> of its <a href=#children>[children]</a>, if any.

        </p><p>An <a href=#element>element</a> is mapped to an <a href=#element-information-item>element
        information item</a> whose <a href=#local-name-0>[local name]</a> is
        the <a href=#element>element</a>'s <a href=#local-name>local
        name</a>, <a href=#namespace-name>[namespace name]</a> is
        the <a href=#element>element</a>'s <a href=#namespace>namespace</a>,
        <a href=#children>[children]</a> is the <a href=#mapped-children>mapped children</a> of
        the <a href=#element>element</a>, <a href=#attributes>[attributes]</a> is
        the <a href=#mapped-attributes>mapped attributes</a> of
        the <a href=#element>element</a>, and <a href=#base-uri>[base URI]</a> is
        the <a href=#element>element</a>'s <a href=#node-document>node
        document</a>'s <a href=#document-base-url>document base URL</a>.  If
        the <a href=#element>element</a>'s <a href=#parent>parent</a> is
        a <a href=#node>node</a>, the <a href=#element-information-item>element information
        item</a>'s <a href=#parent-0>[parent]</a> is the <a href=#information-item>information
        item</a> mapped from
        the <a href=#element>element</a>'s <a href=#parent>parent</a>.

        </p><p>An <a href=#attribute>attribute</a> is mapped to an <a href=#attribute-information-item>attribute
        information item</a> whose <a href=#local-name-0>[local name]</a> is
        the <a href=#attribute>attribute</a>'s <a href=#local-name>local
        name</a>, <a href=#namespace-name>[namespace name]</a> is
        the <a href=#attribute>attribute</a>'s <a href=#namespace>namespace</a>,
        and <a href=#normalized-value>[normalized value]</a> is
        the <a href=#attribute>attribute</a>'s <a href=#attribute-value title="attribute
        value">value</a>.

        </p><p>A <span>text</span> is mapped to a sequence of zero or
        more <a href=#character-information-item title="character information item">character
        information items</a>, whose <a href=#character-code>[character code]</a>
        values' <a href=#concatenate title=concatenate>concatenation</a>
        as <a href=#code-point title="code point">code points</a>, in the same
        order, is equal to the <span>text</span>'s <span>data</span>.

        </p><p>The <dfn id=mapped-children>mapped children</dfn> of a <a href=#node>node</a> is
        a <a href=#list>list</a> of the <a href=#information-item title="information
        item">information items</a> mapped from
        the <a href=#element>element</a>
        and <span>text</span> <a href=#child title=child>children</a> of
        the <a href=#node>node</a>, excluding any <a href=#node>node</a>
        in <var>non-RDF nodes</var>, in the same order.

        </p><p>The <dfn id=mapped-attributes>mapped attributes</dfn> of an <a href=#element>element</a>
        is a <a href=#list>list</a> of the <a href=#attribute-information-item title="attribute
        information item">attribute information items</a> mapped
        from the <a href=#attribute title=attribute>attributes</a> in
        the <a href=#attribute-list>attribute list</a> of the <a href=#element>element</a>,
        excluding any <a href=#node>node</a> in <var>non-RDF nodes</var>,
        in the same order.

        </p><p>Any other <a href=#node>node</a> "attached" to
        the <a href=#node>node</a>, including but not limited to other
        kinds of <a href=#child title=child>children</a> such
        as <a href=#processing-instruction title="processing instruction">processing
        instructions</a>
        and <a href=#comment title=comment>comments</a>, <a href=#template-content>template
        content</a>, and <a href=#shadow-tree>shadow tree</a> is added
        to <var>non-RDF nodes</var>.

      </p></li><li>

        <p>Let <var>events</var> be the result of invoking the steps
        to <a href=#transform-the-infoset-into-the-sequence-of-events-in-document-order>transform the Infoset into the sequence of events
        in <i>document order</i></a> with <var>infoset</var>.

        </p><p>When
        <a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html#eventterm-element-attributes>an
        attribute information item is removed</a>, add
        the <a href=#attribute>attribute</a> from which the <a href=#attribute-information-item>attribute
        information item</a> is created to <var>non-RDF nodes</var>
        unless it is a <code>base</code>
        or <code>lang</code> <a href=#attribute>attribute</a> in the <span>XML
        namespace</span>.

      </p></li><li>
    
        <p>Let <var>graph</var> be the <a href=#rdf-graph>RDF graph</a> obtained
        by
        <a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html#x6-syntax-data-model>matching <var>events</var>
        with the grammer</a>.
  
        </p><p><a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html#x7-2-1-grammar-start>The
        grammer starts with production</a> <code title="">doc</code>
        if <var>node</var> is a <a href=#document>document</a>,
        or <code title="">RDF</code> otherwise.

        </p><p>If <var>events</var> does not match to the grammer
        production, add the <a href=#node>node</a> which is transformed to
        the first event preventing the match into <var>non-RDF
        nodes</var>.  Otherwise, break.

    </p></li></ol>

  </li><li>Return <var>graph</var> and <var>non-RDF nodes</var>.

</li></ol>

<!-- XXX need to define interaction with XML Base specification -->
<p>The <a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html#h4_section-Infoset-Grammar-Action><dfn id=rdfxml-resolve title=rdfxml-resolve><code>resolve (<var>e</var>,
<var>s</var>)</code></dfn></a> grammer action in <a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html>RDF/XML</a>
<em class=rfc2119>MUST</em> run the following steps:

  </p><ol class=steps>

  <li>Let <var title="">url</var> be the result of <a href=http://www.whatwg.org/specs/web-apps/current-work/#resolve-a-url>resolving</a>
  <var title="">s</var> relative to the <a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html#eventterm-element-base-uri>base-uri</a>
  accessor of <var title="">e</var>, using <i>character encoding</i>
  <a href=#utf-8><code>utf-8</code></a>.

  </li><li>If <var title="">url</var> is in error, return <var title="">s</var>.

  </li><li>Otherwise, return <var title="">url</var>.

  </li></ol>

<p>The value of RDF/XML attributes whose value is directly <a href=#rdfxml-resolve title=rdfxml-resolve>resolved</a> as an IRI reference <em class=rfc2119>MUST</em> be a <a href=#valid-url>valid URL</a>.

</p><p>The <span>lexical form</span> of an <span>RDF literal</span> <em class=rfc2119>MUST</em> conform to the relevant requirements of the
<span>datatype</span> of the <span title="RDF literal">literal</span>
except when it is embedded in an RDF/XML fragment as <a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html#parseTypeLiteralPropertyElt><code>parseTypeLiteralPropertyElt</code></a>
or <a href=https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-xml/index.html#parseTypeOtherPropertyElt><code>parseTypeOtherPropertyElt</code></a>.

  </p><div class="note memo">

  <p>An <a href=#xml-literal>XML literal</a> embedded using RDF/XML's feature is
  validated as part of the document.  Result of the validation might
  be different from the validation result of the <span>lexical
  form</span> if the <a href=#xml-literal>XML literal</a> is not self-contained.

  </p></div>

<p>If the <span>lexical form</span> of an <span>RDF literal</span> is
defined as an HTML or XML document (or a fragment of an HTML or XML
document), it <em class=rfc2119>MUST</em> be parsed with appropriate
<span>HTML parser</span> or <span>XML parser</span> with following
configurations:

  </p><ul>

  <li>The <a href=#document><code>Document</code></a> associated with the parser is not in
  any <span>browsing context</span>.

    <div class="note memo">

    <p>That is, no script is executed and no external resource is
    retrieved by the parser.

    </p></div>

  </li><li>If the parser has the <span>scripting flag</span>, whether it is
  set or not depends on the context in which the <span>lexical
  form</span> appears.  If it is contained in a <a href=#node><code>Node</code></a>, the
  <span>scripting flag</span> is set if and only if <span>scripting is
  enabled</span> for the <a href=#node><code>Node</code></a>.

  </li><li>If the parser is affected by locale, it is set to
  <code>en</code> (English).

  </li></ul>

</section>


</section>

<section>
<h2 id=rss-elements><span class=secno>6 </span>RSS elements</h2>

<p>An <a href=#element>element</a> is an <dfn id=rss2-element>RSS2 element</dfn> if and only
if it is in no namespace and either it is the <a href=#document-element-0>document
element</a> and its <a href=#local-name>local name</a> is <code>rss</code> or
one of its <a href=#ancestor>ancestor</a> is an <a href=#rss2-element>RSS2 element</a>.

</p><div class="note memo">

<p>In other words, <span>elements</span> in no
namespace are <a href=#rss2-element>RSS2 element</a> if they belong to the main
document tree whose <a href=#document-element-0>document element</a> is the
<code>rss</code> element in no namespace.

</p></div>

<p><a href=#rss2-element title="RSS2 element">RSS2 elements</a> are interpreted as
described by RSS2 specifications <cite class="bibref normative">[<a href=#ref-RSS2>RSS2</a>]</cite> <cite class="bibref normative">[<a href=#ref-RSSPROFILE>RSSPROFILE</a>]</cite>.

</p></section>

<section>
<h2 id=atom-elements><span class=secno>7 </span>Atom elements</h2>

<p>Atom and its extension specifications allow extensions such that
almost everything is allowed, which is not useful for conformance
checker.  This specification defines stricter restrictions for the
purpose of conformance checking.

</p><p><dfn id=atom-family-namespaces>Atom family namespaces</dfn> are
<a href=https://github.com/mnot/I-D/blob/master/Published/atom-format/draft-nottingham-atom-format-02.xml><code>http://purl.org/atom/ns#</code></a>,
<a href=http://tools.ietf.org/html/rfc4287><code>http://www.w3.org/2005/Atom</code></a>,
<a href=http://tools.ietf.org/html/rfc4685><code>http://purl.org/syndication/thread/1.0</code></a>,
<a href=https://tools.ietf.org/html/rfc5005><code>http://purl.org/syndication/history/1.0</code></a>,
<a href=https://tools.ietf.org/html/rfc5023><code>http://www.w3.org/2007/app</code></a>,
and
<a href=http://tools.ietf.org/html/rfc6721><code>http://purl.org/atompub/tombstones/1.0</code></a>.

</p><p>An <dfn id=atom-family-element>Atom family element</dfn> is an <a href=#element>element</a> in one
of <a href=#atom-family-namespaces>Atom family namespaces</a>.

</p><p>Constraints expressed in RELAX NG schema fragments in an <a href=#applicable-specification title="applicable specification">applicable specifications</a> for
<a href=#atom-family-namespaces>Atom family namespaces</a> are to be interpreted as <em class=rfc2119>MUST</em>-level requirements for the purpose of
conformance checking.

</p><p><a href=#comment title=comment>Comments</a>, <a href=#inter-element-whitespace title="inter-element
whitespace">inter-element whitespaces</a>, and
<span>processing instructions</span> <em class=rfc2119>MAY</em> be
inserted anywhere in an <a href=#atom-family-element>Atom family element</a>.

</p><p>For an <a href=#atom-family-element>Atom family element</a>, an <a href=#attribute>attribute</a>
or <spanchild>child that is not explicitly allowed by
an <a href=#applicable-specification>applicable specification</a> <em class=rfc2119>MUST
NOT</em> be used.

</spanchild></p><p>An <a href=#unknown-namespace-element>unknown namespace
element</a> <em class=rfc2119>MAY</em> be used as
a <a href=#child title=child>child</a> of <dfn id=atom-extensible-element title="Atom extensible
element">Atom extensible elements</dfn>, i.e. following elements:

  </p><ul>

  <li><a href=#atom-family-element title="Atom family element">Atom family elements</a>
  which allow <span title="extension element">extension
  elements</span>, <code>extensionElement</code>, or
  <code>extensionSansTitleElement</code> in content

  </li><li><code>deleted-entry</code> elements in namespace
  <code>http://purl.org/atompub/tombstones/1.0</code>

  </li><li><code>feed</code> elements in namespace
  <code>http://purl.org/atom/ns#</code>

  </li><li><code>entry</code> elements in namespace
  <code>http://purl.org/atom/ns#</code>

  </li></ul>

<p>If the content of an <a href=#atom-family-element>Atom family element</a> is defined as
HTML or XHTML fragment, it <em class=rfc2119>MUST</em> conform to
relevant requirements in <a href=#applicable-specification title="applicable
specification">applicable specifications</a>, using the rules for
<a href=#html-document title="HTML document">HTML</a> or <a href=#xhtml-document title="XHTML
document">XHTML documents</a>, respectively.<!-- SHOULD in RFC
4287; HTML4 and XHTML1 in RFC 4287 -->

</p><p>Elements <code>complete</code> and <code>archive</code> in
namespace <code>http://purl.org/syndication/history/1.0</code> <em class=rfc2119>MUST NOT</em> be used more than once in an
<code>feed</code> element in namespace
<code>http://www.w3.org/2005/Atom</code>.

</p><p>Concepts used to describe constraints for <a href=#atom-family-element title="Atom family
element">Atom family elements</a> <em class=rfc2119>MUST</em> be
interpreted as following:

  </p><dl class=switch>

  <dt>RFC 3066 language tag
  </dt><dd><a href=#valid-language-tag>Valid language tag</a>

  </dd><dt>URI
  </dt><dt>IRI
  </dt><dt>IRI reference
  </dt><dd><a href=#valid-url>Valid URL</a> (If IRI and IRI reference are
  distinguished, <a href=#valid-absolute-url>valid absolute URL</a> and <a href=#valid-url>valid
  URL</a>, respectively.)

  </dd><dt>Media type
  </dt><dt>MIME media type
  </dt><dd><a href=#valid-mime-type>Valid MIME type</a>

  </dd><dt><code>addr-spec</code>
  </dt><dt>E-mail address
  </dt><dd><a href=#valid-e-mail-address>Valid e-mail address</a>

  </dd><dt>W3C Date-Time string
  </dt><dd>Same as element content of <a href=#date-construct>Date construct</a>

  </dd></dl>

<p class=ed>XXX need to define &lt;atom:content&gt; content validation
when type is a MIME type

</p></section>

<section>
<h2 id=ogp><span class=secno>8 </span>OGP</h2>

<p>An HTML <code>meta</code> element <em class=rfc2119>MAY</em> have a
<dfn id=attr-meta-property title=attr-meta-property><code>property</code></dfn> attribute.
If the attribute is specified, the element <em class=rfc2119>MUST
NOT</em> have a <code title=attr-meta-name>name</code> attribute or an
attribute that cannot be used when a <code title=attr-meta-name>name</code> attribute is specified.  The <code title=attr-meta-content>content</code> attribute <em class=rfc2119>MUST</em> be specified if a <a href=#attr-meta-property><code title=attr-meta-property>property</code></a> attribute is specified.  An
HTML <code>meta</code> element with <a href=#attr-meta-property><code title=attr-meta-property>property</code></a> attribute is <span>metadata
content</span> (it is not a <span>phrasing content</span>).

</p><p>The value of a <a href=#attr-meta-property><code title=attr-meta-property>property</code></a>
attribute <em class=rfc2119>MUST</em> be an <a href=#ogp-property-name>OGP property
name</a>.  A <dfn id=ogp-property-name>OGP property name</dfn> is a <a href=#attr-meta-property><code title=attr-meta-property>property</code></a> value defined by an
<a href=#applicable-specification>applicable specification</a> or a <a href=#prefixed-property-value>prefixed property
value</a>.  A <dfn id=prefixed-property-value>prefixed property value</dfn> is a
<a href=#property-prefix>property prefix</a> followed by a <code>U+003A</code> <code class=charname>COLON</code> character (<code>:</code>) followed by one
or more characters.  A <dfn id=property-prefix>property prefix</dfn> is a string of one
or more characters that is not a <code>U+003A</code> <code class=charname>COLON</code> character (<code>:</code>) and is not used
by <a href=#attr-meta-property><code title=attr-meta-property>property</code></a> value defined by an
<a href=#applicable-specification>applicable specification</a> as prefix.  A <i>deprecated</i>
<a href=#attr-meta-property><code title=attr-meta-property>property</code></a> value <em class=rfc2119>SHOULD NOT</em> be used.

</p><p>A <a href=#attr-meta-property><code title=attr-meta-property>property</code></a> value <em class=rfc2119>MUST NOT</em> be used unless it is defined in the
context it is used by an <a href=#applicable-specification>applicable specification</a>.

  </p><div class="note memo">

  <p>Many <a href=#attr-meta-property><code title=attr-meta-property>property</code></a> values are
  only defined for speciic <a href=#og:type><code>og:type</code></a> values.

  </p></div>

<p>If the <a href=#attr-meta-property><code title=attr-meta-property>property</code></a> attribute
value is <dfn id=og:type><code>og:type</code></dfn>, the <code title=attr-meta-content>content</code> attribute value <em class=rfc2119>MUST</em> be a value allowed as an <a href=#og:type><code>og:type</code></a>
value or a <a href=#prefixed-property-value>prefixed property value</a>.

  </p><div class="note memo">

  <p>An example of <a href=#applicable-specification title="applicable specification">applicable
  specifications</a> is <a href=http://ogp.me/><cite>The Open
  Graph protocol</cite></a>.

  </p></div>

</section>

<section>
<h3 id=document-element><span class=secno>9 </span>Document element</h3>

<p class=section-info><em>This section is non-normative.</em>

</p><p>Whether an element can be used as the <a href=#document-element-0>document element</a>
or not is determined by following steps:

</p><ol class=steps>

<li><a href=#determine-the-validation-mode>Determine the validation mode</a> of the element.

</li><li>If the element is in the <a href=#xslt-mode>XSLT mode</a>, return whether
the element is allowed as the <a href=#document-element-0>document element</a> according
to <a href=#xslt-specifications>XSLT specifications</a>.

</li><li>Otherwise, if the element is in the <a href=#rdf-mode>RDF mode</a>, return
whether the element is allowed as the <a href=#document-element-0>document element</a>
according to RDF/XML specification.

</li><li>Otherwise, if the element is in the <a href=#rss1-mode>RSS1 mode</a>, in a
<a href=#supported-namespace>supported namespace</a>, or an <a href=#rss2-element>RSS2 element</a>,
return whether the element is allowed as the <a href=#document-element-0>document
element</a> by an <a href=#applicable-specification>applicable specification</a>.

</li><li>Otherwise, the element is an <a href=#unknown-namespace-element>unknown namespace
element</a>.  Return true.

</li></ol>

</section>

<section>
<h3 id=checking-an-element><span class=secno>10 </span>Checking an element</h3>

<p class=section-info><em>This section is non-normative.</em>

</p><p>Conformance of an element is checked as follows:

</p><ol class=steps>

<li><a href=#determine-the-validation-mode>Determine the validation mode</a> of the element.

</li><li>Let <var>mode</var> be the <a href=#validation-mode>validation mode</a> of the
element.

</li><li>If <var>mode</var> is <a href=#xslt-mode>XSLT mode</a>, check the element
according to <a href=#xslt-specifications>XSLT specifications</a>.

</li><li>Otherwise, if <var>mode</var> is <a href=#rdf-mode>RDF mode</a>, check the
element according to the RDF/XML specification.

</li><li>Otherwise, if <var>mode</var> is <a href=#rss1-mode>RSS1 mode</a>, check the
element according to the RDF/XML specification and <a href=#rss1-specifications>RSS1
specifications</a>.

</li><li>Otherwise, if the element is in a <a href=#supported-namespace>supported namespace</a>
or is an <a href=#rss2-element>RSS2 element</a>:

  <ol>

  <li>If the element is defined in an <a href=#applicable-specification>applicable
  specification</a>, check the element according to the
  specification.

  </li><li>Otherwise, report an "unknown element" error.

  </li></ol>

</li><li>Otherwise, the element is an <a href=#unknown-namespace-element>unknown namespace
element</a>.  Report an "unknown element" warning.

</li></ol>

</section>

<section>
<h2 id=data><span class=secno>11 </span>Data</h2>

<p class=section-info><em>This section is non-normative.</em>

</p><p>The <a href=https://github.com/manakai/data-web-defs/>data-web-defs</a>
repository contains some machine-readable data for definitions in this
specification.

</p><p>The tests-web repository contains <a href=https://github.com/wakaba/tests-web/tree/master/xml/validation>conformance
checking test data</a>.

</p></section>

<section class="reference normative">
<h2 class=no-num id=references>References</h2>

<dl>

<dt id=ref-RSS2>RSS2
</dt><dd><a href=http://www.rssboard.org/rss-specification><cite>RSS 2.0</cite></a>, RSS Advisory Board.

</dd><dt id=ref-RSSPROFILE>RSSPROFILE
</dt><dd><a href=http://www.rssboard.org/rss-profile><cite>Really Simple Syndication Best Practices Profile</cite></a>, RSS Advisory Board.

</dd><dt id=ref-XML>XML
</dt><dd><a href=http://www.w3.org/TR/xml/><cite>Extensible Markup Language (XML)</cite></a>, W3C Recommendation.

</dd><dt id=ref-XMLNS>XMLNS
</dt><dd><a href=http://www.w3.org/TR/xml-names/><cite>Namespaces in XML</cite></a>, W3C Recommendation.

</dd></dl>

</section>


<section>
<h1 class=no-num id=author>Author</h1>

<p>This document is written by
<a href=https://suika.suikawiki.org/~wakaba/who?>Wakaba</a>
&lt;wakaba@suikawiki.org&gt;.

</p><p>This document is developed as part of the
<a href=https://manakai.github.io/>the manakai project</a>.

</p><p>Per
<a href=https://creativecommons.org/publicdomain/zero/1.0/>CC0</a>, to
the extent possible under law, the author has waived all copyright and
related or neighboring rights to this work.

</p></section>
</body></html>