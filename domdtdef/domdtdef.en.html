<!DOCTYPE html><html class="formal-specification anolis" lang=en><head>
<title>DOM Document Type Definitions</title>
<link href=http://suika.suikawiki.org/www/style/html/spec rel=stylesheet>
<link href=http://suika.suikawiki.org/www/style/def/dom rel=stylesheet>
<link href=http://suika.suikawiki.org/c/gnu/fdl rel=license>
</head>
<body class=has-abstract>

<div class=header>
<h1 class="no-toc no-num">DOM Document Type Definitions</h1>
<h2 class="no-toc no-num" id=manakai-project-living-standard-date>Manakai Project Living Standard 1 February 2013</h2>

<dl class=versions-uri>
<dt>Latest Version</dt>
  <dd><code class=URI>&lt;<a href=http://suika.suikawiki.org/www/markup/xml/domdtdef/domdtdef>http://suika.suikawiki.org/www/markup/xml/domdtdef/domdtdef</a>&gt;</code></dd>
<dt>First Edition</dt>
  <dd><code class=URI>&lt;<a href=http://suika.suikawiki.org/www/markup/xml/domdtdef/domdtdef-20071209>http://suika.suikawiki.org/www/markup/xml/domdtdef/domdtdef-20071209</a>&gt;</code></dd>
<dt>Version History</dt>
  <dd><code class=URI>&lt;<a href=http://suika.suikawiki.org/gate/git/wi/markup/xmlexts.git/history/HEAD:/domdtdef/source.en.html>http://suika.suikawiki.org/gate/git/wi/markup/xmlexts.git/history/HEAD:/domdtdef/source.en.html</a>&gt;</code></dd>
<dt id=author>Author</dt>
  <dd><a href=http://suika.suikawiki.org/~wakaba/who? lang=ja rel=author>Wakaba</a>
  <code class=mail>&lt;<a href=mailto:wakaba@suikawiki.org rel=author>wakaba@suikawiki.org</a>&gt;</code></dd>
</dl>

<p class=copyright lang=en>Â© <time>2007</time>-<time>2013</time> <a href=http://suika.suikawiki.org/~wakaba/who? rel=author>Wakaba</a>.
Permission is granted to copy, distribute and/or modify this document
under the terms of the <a href=http://www.gnu.org/copyleft/fdl.html rel=license>GNU Free Documentation License</a>,
Version 1.2
or any later version published by the <a href=http://www.fsf.org/>Free Software Foundation</a>;
with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
Texts.  A copy of the license is
available at <code class=URI>&lt;<a href=http://www.gnu.org/copyleft/fdl.html rel=license>http://www.gnu.org/copyleft/fdl.html</a>&gt;</code>.</p>
</div>

<div class=section id=abstract>
<h2 class="no-toc no-num" id=abstract-0>Abstract</h2>

<p>The <abbr>DOM</abbr> Document Type Definitions specification
defines a set of <abbr>DOM</abbr> interfaces, including both new
interfaces and modifications to existing <abbr>DOM</abbr> interfaces,
over which <abbr>DOM</abbr> applications are able to access to the
definitions of the document type.</p> </div>

<div class=section id=status>
<h2 class="no-toc no-num" id=status-of-this-document>Status of This Document</h2>

<p class=section-info>This section describes the status of this document at the
time of its publication.  Other documents might supersede this document.</p>

<p>This document is a specification produced as part of the <a href=http://suika.suikawiki.org/www/manakai-core/doc/web/>manakai</a>
project.  It is not intended to be implemented by any other DOM
implementation, although nothing prevents it from being implemented by
any other party.  It might be updated, replaced, or obsoleted by other
documents at any time.

</p><p class=ed>This specification was originllay developed in DOM3 age.
Most part of this document need to be rewritten to align with modern
Web standard specifications.

</p><p>Comments on this document are welcome and
may be sent to the <a href=#author>author</a>.</p>

<p>Translations of this document might be available.
The English version of the document is the only
normative version.</p>
</div>

<div class=section>
<h2 class="no-toc no-num" id=table-of-contents>Table of contents</h2>

<!--begin-toc-->
<ol class=toc>
 <li><a href=#introduction-0><span class=secno>1 </span>Introduction</a></li>
 <li><a href=#conformance-requirements><span class=secno>2 </span>Conformance Requirements</a>
  <ol>
   <li><a href=#terminology-0><span class=secno>2.1 </span>Terminology</a></li></ol></li>
 <li><a href=#Node><span class=secno>3 </span>Nodes</a></li>
 <li><a href=#Document><span class=secno>4 </span>Documents</a></li>
 <li><a href=#document-types><span class=secno>5 </span>Document types</a></li>
 <li><a href=#element-types><span class=secno>6 </span>Element types</a></li>
 <li><a href=#attribute-definitions><span class=secno>7 </span>Attribute definitions</a></li>
 <li><a href=#general-entities><span class=secno>8 </span>General entities</a></li>
 <li><a href=#notations><span class=secno>9 </span>Notations</a></li>
 <li><a href=#base-urls><span class=secno>10 </span>Base URLs</a></li>
 <li><a href=#obsolete-features><span class=secno>11 </span>Obsolete features</a>
  <ol>
   <li><a href=#the-dom-feature-string-for-the-dom-document-type-definitions><span class=secno>11.1 </span>The DOM feature string for the DOM Document Type Definitions</a></li>
   <li><a href=#obsolete-attribute><span class=secno>11.2 </span>Obsolete attribute</a></li></ol></li>
 <li><a class=no-num href=#references-0>References</a>
  <ol>
   <li><a class=no-num href=#normative-references-0>Normative References</a></li>
   <li><a class=no-num href=#non-normative-references>Non-normative References</a></li></ol></li></ol>
<!--end-toc-->
</div>

<div class=section id=introduction>
<h2 id=introduction-0><span class=secno>1 </span>Introduction</h2>

<p class=section-info>This section is <em>non-normative</em>.</p>

<p>The <dfn id=term-dom-dtdef><abbr>DOM</abbr> Document Type
Definitions</dfn> specification defines a set of <abbr>DOM</abbr>
interfaces, including both new interfaces and modifications to
existing <abbr>DOM</abbr> interfaces, over which <abbr>DOM</abbr>
applications are able to access to the definitions of the document
type.</p>

<p>The primary goal of the features defined by this specification is
to make it possible to built an XML DTD validator on the top of the
extended DOM API (combined with an XML parser implementation aware of
that API).  It supports both XML 1.0 <cite class="bibref
normative">[<a href=#ref-XML10>XML10</a>]</cite> and XML 1.1 <cite class="bibref normative">[<a href=#ref-XML11>XML11</a>]</cite>.

</p><p>Interfaces defined in this document are partially modeled and inspired by
early drafts of <abbr>DOM</abbr> Level 1
<cite class="bibref informative">[<a href=#ref-DOM1WD>DOM1WD</a>]</cite>,
<abbr>DOM</abbr> Level 3 Abstract Schemas <abbr>W3C</abbr> Note
<cite class="bibref informative">[<a href=#ref-DOM3AS>DOM3AS</a>]</cite>,
and <abbr>XML</abbr> Schema <abbr>API</abbr> specification
<cite class="bibref informative">[<a href=#ref-XSAPI>XSAPI</a>]</cite>, but 
they are not compatible with any of them as a whole.</p>
</div>

<div class=section id=conformance>
<h2 id=conformance-requirements><span class=secno>2 </span>Conformance Requirements</h2>

<div class=section id=terminology>
<h3 id=terminology-0><span class=secno>2.1 </span>Terminology</h3>

<p>All examples and notes in this specification are non-normative,
as are all sections explicitly marked non-normative.</p>

<p class=ed>Known issues are marked like this.  They are non-normative.  <!--
However, this paragraph itself is normative.  One may argue that this paragraph
is non-normative, because this paragraph is marked as an editor's note. 
Anyway, the other editor's notes are non-normative. --></p>

<p>Everything else in this document is normative.</p>

<p>The key words <q><em class=rfc2119>MUST</em></q>,
<q><em class=rfc2119>MUST NOT</em></q>, and <q><em class=rfc2119>MAY</em></q>
in this document are to be interpreted as described in 
<a href=urn:ietf:rfc:2119><abbr title="Request for Comments">RFC</abbr> 
2119</a>
<cite class="bibref normative">[<a href=#ref-KEYWORDS>KEYWORDS</a>]</cite>.</p>

<p>Conformance requirements phrased as algorithms or specific steps 
<em class=rfc2119>MAY</em> be implemented in any manner, so long as the end
result is equivalent.  Requirements phrased in the imperative as part of 
algorithms are to be interpreted with the meaning of the key word used in 
introducing the algorithm.</p>

<div class=ed>

<p>The following paragraph is no longer applied, but
strictErrorChecking has effect for certain methods (need to define
them...)

</p><p>Sometimes an exception is phrased as being required to be raised.  As
specified in the <abbr>DOM</abbr> Core specification
<cite class="bibref normative">[<a href=#ref-DOM3CORE>DOM3CORE</a>]</cite>,
when the value of the <code>strictErrorChecking</code> attribute of the
<a href=#Document><code>Document</code></a> node is <code>false</code>,
then the exception is not have to be raised.</p>
</div>

<p>Some conformance requirements are phrased as requirements on interfaces,
attributes, methods, or objects.  Such requirements are applied to
implementations.</p>

<p>The construction <q>a <code><var title="">Foo</var></code> object</q>,
where <code><var title="">Foo</var></code> is an interface, is used
instead of the more accurate <q>an object implementing the interface
<code><var title="">Foo</var></code></q>.</p>

<p class=ed>The construction <q>raise a
<code><var>Bar</var></code></q>, where <code><var>Bar</var></code> is
an exception code, is used instead of the more accurate <q>raise an
exception implementing the interface <a href=#domexception><code>DOMException</code></a> <cite class="bibref normative">[<a href=#ref-DOM3CORE>DOM3CORE</a>]</cite>
with its <code>code</code> attribute set to
<code><var>Bar</var></code></q>.</p>

<p>The <em id=idl-fragment>WebIDL fragments</em> in this document are
to be interpreted as described in the WebIDL specification <cite class="bibref normative">[<a href=#ref-DOMBIND>DOMBIND</a>]</cite>.</p>

<p>The term <dfn id=null>null</dfn> is definedby the WebIDL specification
<cite class="bibref normative">[<a href=#ref-DOMBIND>DOMBIND</a>]</cite>.

</p><p>The terms, interfaces, attributes, and exceptions <dfn id=context-object>context
object</dfn>, <dfn id=xml-namespace>XML namespace</dfn>, <dfn id=concept-tree-child title=concept-tree-child>child</dfn>, <dfn id=concept-tree-parent title=concept-tree-parent>parent</dfn>, <dfn id=node><code>Node</code></dfn>,
<dfn id=attr><code>Attr</code></dfn>, <dfn id=document>document</dfn>
(<dfn id=document-0><code>Document</code></dfn>), <dfn id=in-a-document>in a document</dfn>, <dfn id=concept-doctype title=concept-doctype>doctype</dfn>
(<dfn id=documenttype><code>DocumentType</code></dfn>), <dfn id=concept-doctype-name title=concept-doctype-name>doctype name</dfn>, <dfn id=dom-node-nodename title=dom-Node-nodeName><code>nodeName</code></dfn>, <dfn id=concept-node-adopt title=concept-node-adopt>adopt</dfn>, <dfn id=concept-node-document title=concept-node-document>node document</dfn>, <dfn id=concept-node-clone title=concept-node-clone>clone</dfn>, <dfn id=concept-node-base-url title=concept-node-base-url>base URL</dfn>, <dfn id=concept-collection title=concept-collection>collection</dfn>, <dfn id=throw>throw</dfn>,
<dfn id=domexception><code>DOMException</code></dfn>,
<dfn id=hierarchyrequesterror><code>HierarchyRequestError</code></dfn>,
<dfn id=invalidcharactererror><code>InvalidCharacterError</code></dfn>, and
<dfn id=notfounderror><code>NotFoundError</code></dfn> are defined by the DOM Standard
<cite class="bibref normative">[<a href=#ref-DOM>DOM</a>]</cite>.

</p><p>The terms <em id=live><a href=http://www.whatwg.org/specs/web-apps/current-work/#live>live</a></em>,
<dfn id=document-base-url>document base URL</dfn>, <dfn id="the-document's-address">the document's address</dfn>, <dfn id=resolve-a-url title="resolve a URL">resolve a URL</dfn>, <dfn id=willful-violation>willful
violation</dfn>, and <em id=setting>setting</em> and <em id=getting>getting</em> of an attribute is defined in the HTML5
specification <cite class="bibref normative">[<a href=#ref-HTML5>HTML5</a>]</cite>.</p>

<p>The interfaces and attributes
<dfn id=namednodemap><code>NamedNodeMap</code></dfn><!-- XXX or AttrExodus? -->, <a href=http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/DOM3-Core.html#core-ID-1788794630><dfn id=dom-documenttype-entities title=dom-DocumentType-entities><code>entities</code></dfn></a>, <a href=http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/DOM3-Core.html#core-ID-D46829EF><dfn id=dom-documenttype-notations title=dom-DocumentType-notations><code>notations</code></dfn></a>,
<dfn id=entity><code>Entity</code></dfn>, and <dfn id=notation><code>Notation</code></dfn>
are defined in the DOM3 Core specification <cite class="bibref
normative">[<a href=#ref-DOM3CORE>DOM3CORE</a>]</cite>.

</p><p>The term <dfn id=concept-attribute-owner-element title=concept-attribute-owner-element>owner
element</dfn> is defined in the <cite>Manakai DOM Extensions</cite>
specification <cite class="bibref normative">[<a href=#ref-MANAKAI>MANAKAI</a>]</cite>.

</p><p>The term <a href=http://www.w3.org/TR/xml/#NT-Name><dfn id=name><code>Name</code></dfn></a>
is defined in the XML 1.0 specification <cite class="bibref
normative">[<a href=#ref-XML10>XML10</a>]</cite>.

</p><div class=ed>
<p>Following paragraph need to be updated:

</p><p>Some <abbr>IDL</abbr> fragments are presented as <i>patch</i> to an
<abbr>IDL</abbr> fragment defined in another document.  They are to be
interpreted as an instance of
<a href=http://www.w3.org/TR/2007/WD-DOM-Bindings-20071017/#proddef-InterfaceMembers><code>InterfaceMembers</code></a>
<cite class="bibref normative">[<a href=#ref-DOMBIND>DOMBIND</a>]</cite>.
If the <abbr>IDL</abbr> fragment to which the <i>patch</i> is applied has any 
instance of
<a href=http://www.w3.org/TR/2007/WD-DOM-Bindings-20071017/#proddef-InterfaceMember><code>InterfaceMember</code></a>
with same 
<a href=http://www.w3.org/TR/2007/WD-DOM-Bindings-20071017/#prod-identifier><code>identifier</code></a>
part as that of an instance of 
<a href=http://www.w3.org/TR/2007/WD-DOM-Bindings-20071017/#proddef-InterfaceMember><code>InterfaceMember</code></a>
in the <i>patch</i>, then the former instance of
<a href=http://www.w3.org/TR/2007/WD-DOM-Bindings-20071017/#proddef-InterfaceMember><code>InterfaceMember</code></a>
<em class=rfc2119>MUST</em> be ignored.</p>

</div>

</div><!-- section -->

</div><!-- section -->

<div class=section id=section-node>
<h2 id=Node><span class=secno>3 </span>Nodes</h2>

<p>This specification introduces two kinds of <span class=concept-node>nodes</span>: <a href=#concept-element-type title=concept-element-type>element types</a> and <a href=#concept-attribute-definition title=concept-attribute-definition>attribute definitions</a>.
Also, this specification reuses two kinds of nodes defined by DOM3
Core specification <cite class="bibref normative">[<a href=#ref-DOM3CORE>DOM3CORE</a>]</cite> (but obsoleted by current
DOM Standard <cite class="bibref normative">[<a href=#ref-DOM>DOM</a>]</cite>): <a href=#concept-entity title=concept-entity>entities</a> and <a href=#concept-notation title=concept-notation>notations</a>.  Requirements on <span class=concept-node>nodes</span> are applied by the following rules:

</p><dl class=switch>

<dt>Node types introduced by this specification
(<a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a> and
<a href=#AttributeDefinition><code>AttributeDefinition</code></a>)

</dt><dd>If this specification explicitly states requirements for them,
they have to be followed.  Otherwise, requirements mentioned in the
DOM Standard have to be followed.

</dd><dt><a href=#documenttype><code>DocumentType</code></a>

</dt><dd>If this specification explicitly states requirements for it, they
have to be followed.  Otherwise, requirements mentioned in the DOM
Standard have to be followed.

<div class="note memo">

<p>This specification defines how nodes attached to the
<a href=#documenttype><code>DocumentType</code></a> (e.g. <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a> and
<a href=#entity><code>Entity</code></a>) affect to attributes and methods of the <span title=concept-node>nodes</span>.  When the <a href=#documenttype><code>DocumentType</code></a>
has no such attached node, they are expected to behave as specified by
the DOM Standard.

</p></div>

</dd><dt>Node types defined in DOM3 Core specification but obsoleted by DOM
Standard (<a href=#entity><code>Entity</code></a> and <a href=#notation><code>Notation</code></a>)

</dt><dd>If this specification explicitly states requirements for them,
they have to be followed.  Otherwise, requirements mentioned in the
DOM3 Core specification have to be followed.

</dd><dt>Other node types

</dt><dd>Requirements in the DOM Standard have to be followed.

</dd></dl>

<p>Nodes of types <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a>,
<a href=#AttributeDefinition><code>AttributeDefinition</code></a>, <a href=#entity><code>Entity</code></a>, and
<a href=#notation><code>Notation</code></a> cannot contain, or cannot be contained by, any
kind of node as <a href=#concept-tree-child title=concept-tree-child>child</a>.

</p><div class="note memo">

  <p>Historically, DOM3 Core specification and earlier versions of
  this specification have allowed <a href=#AttributeDefinition><code>AttributeDefinition</code></a> and
  <a href=#entity><code>Entity</code></a> nodes containing <a href=#concept-tree-child title=concept-tree-child>children</a>.

</p></div>

<hr>

<pre class=idl><code>partial interface <a href=#node>Node</a> {
  const unsigned short <a href=#dom-node-element_type_definition_node title=dom-Node-ELEMENT_TYPE_DEFINITION_NODE>ELEMENT_TYPE_DEFINITION_NODE</a> = 81001;
  const unsigned short <a href=#dom-node-attribute_definition_node title=dom-Node-ATTRIBUTE_DEFINITION_NODE>ATTRIBUTE_DEFINITION_NODE</a> = 81002;
};</code></pre>

<p>The <code title=dom-Node-nodeType>nodeType</code> attribute <em class=rfc2119>MUST</em> return the following, depending on the
<a href=#context-object>context object</a>:

</p><dl class=switch>

<dt><a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a>
</dt><dd><dfn id=dom-node-element_type_definition_node title=dom-Node-ELEMENT_TYPE_DEFINITION_NODE><code id=ELEMENT_TYPE_DEFINITION_NODE>ELEMENT_TYPE_DEFINITION_NODE</code></dfn>
(<code>81001</code>)

</dd><dt><a href=#AttributeDefinition><code>AttributeDefinition</code></a>
</dt><dd><dfn id=dom-node-attribute_definition_node title=dom-Node-ATTRIBUTE_DEFINITION_NODE><code id=ATTRIBUTE_DEFINITION_NODE>ATTRIBUTE_DEFINITION_NODE</code></dfn>
(<code>81002</code>)

<!-- For Entity and Notation, defined by DOM3CORE -->
</dd></dl>

<p>The <a href=#dom-node-nodename><code title=dom-Node-nodeName>nodeName</code></a> attribute <em class=rfc2119>MUST</em> return the name (<a href=#concept-element-type-name title=concept-element-type-name>element type name</a> or <a href=#concept-attribute-definition-name title=concept-attribute-definition-name>attribute definition
name</a>) of the node.

</p><p>If the <span title=concept-node>node</span> has attributes <code title=dom-Node-attributes>attributes</code>, <code title=dom-Node-localName>localName</code>, <code title=dom-Node-namespaceURI>namespaceURI</code>, and <code title=dom-Node-prefix>prefix</code>, they <em class=rfc2119>MUST</em>
return <a href=#null><code>null</code></a>.<!-- NodeExodus / AttrExodus -->

</p><p>The <code title=dom-Node-nodeValue>nodeValue</code> attribute and
the <code title=dom-Node-textContent>textContent</code> attribute <em class=rfc2119>MUST</em> return the following, depending on the
<a href=#context-object>context object</a>:

</p><dl class=switch>

<!--
<dt><code>ElementTypeDefinition</code>
<dd><span>Null</span>.
-->

<dt><a href=#AttributeDefinition><code>AttributeDefinition</code></a> </dt><dd>The <a href=#concept-attribute-definition-default-value title=concept-attribute-definition-default-value>default value</a>
of the <a href=#context-object>context object</a>.

</dd><dt><a href=#entity><code>Entity</code></a>
</dt><dd>The <a href=#concept-entity-replacement-text title=concept-entity-replacement-text>replacement
text</a> of the <a href=#context-object>context object</a>.

<!-- For Notation, defined by DOM3CORE -->
</dd></dl>

<p>Setting the <code title=dom-Node-nodeValue>nodeValue</code>
attribute or the <code title=dom-Node-textContent>textContent</code>
attribute <em class=rfc2119>MUST</em> do the following, depending on
the <a href=#context-object>context object</a>:

</p><dl class=switch>

<!--
<dt><code>ElementTypeDefinition</code>
<dd>Do nothing.
-->

<dt><a href=#AttributeDefinition><code>AttributeDefinition</code></a> </dt><dd>Set the <a href=#concept-attribute-definition-default-value title=concept-attribute-definition-default-value>default value</a>
of the <a href=#context-object>context object</a> to the new value.

</dd><dt><a href=#entity><code>Entity</code></a>
</dt><dd>Set the <a href=#concept-entity-replacement-text title=concept-entity-replacement-text>replacement
text</a> of the <a href=#context-object>context object</a> to the new value.

<!-- For Notation, defined by DOM3CORE -->
</dd></dl>

<p>On setting, the <code title=dom-Node-textContent>textContent</code>
attribute <em class=rfc2119>MUST</em> act as if it was the empty
string instead if the new value is <a href=#null>null</a>.

</p><p>When a node is <a href=#concept-node-clone title=concept-node-clone>cloned</a>, the
following values <em class=rfc2119>MUST</em> be copied:

<!-- This list should be equal to isEqualNode's list -->
</p><dl class=switch>

<dt><a href=#documenttype><code>DocumentType</code></a>
<!-- Modify DOM definition -->
</dt><dd>Its <a href=#concept-documenttype-elementtypes title=concept-DocumentType-elementTypes>element
types</a>, <a href=#concept-documenttype-generalentities title=concept-DocumentType-generalEntities>general
entities</a>, and <a href=#concept-documenttype-notations title=concept-DocumentType-notations>notations</a>.

</dd><dt><a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a> </dt><dd>Its <a href=#concept-element-type-name title=concept-element-type-name>name</a> and <a href=#concept-elementtypedefinition-attributedefinitions title=concept-ElementTypeDefinition-attributeDefinitions>attribute
definitions</a>.<!-- XXX content model -->

</dd><dt><a href=#AttributeDefinition><code>AttributeDefinition</code></a> </dt><dd>Its <a href=#concept-attribute-definition-name title=concept-attribute-definition-name>name</a>, <a href=#concept-attribute-definition-declared-type title=concept-attribute-definition-declared-type>declared type</a>,
<a href=#concept-attribute-definition-allowed-tokens title=concept-attribute-definition-allowed-tokens>allowed
tokens</a>, <a href=#concept-attribute-definition-default-type title=concept-attribute-definition-default-type>default type</a>,
and <a href=#concept-attribute-definition-default-value title=concept-attribute-definition-default-value>default
value</a>.

</dd><dt><a href=#entity><code>Entity</code></a>
<!-- Implementation dependent in DOM3CORE -->
</dt><dd>Its <span title=concept-entity-name>name</span>, <a href=#concept-entity-publicid title=concept-entity-publicid>public ID</a>, <a href=#concept-entity-systemid title=concept-entity-systemid>system ID</a>, <a href=#concept-entity-notation-name title=concept-entity-notation-name>notation name</a>, and <a href=#concept-entity-replacement-text title=concept-entity-replacement-text>replacement text</a>.

</dd><dt><a href=#notation><code>Notation</code></a>
<!-- Implementation dependent in DOM3CORE -->
</dt><dd>Its <span title=concept-notation-name>name</span>, <a href=#concept-notation-publicid title=concept-notation-publicid>public ID</a>, and <a href=#concept-notation-systemid title=concept-notation-systemid>system ID</a>.

</dd></dl>

<p>When two nodes are compared for the <code title=dom-Node-isEqualNode>isEqualNode</code> method, equality of the
following values <em class=rfc2119>MUST</em> also be taken into
account:

<!-- This list should be equal to cloneNode's list -->
</p><dl class=switch>

<dt><a href=#documenttype><code>DocumentType</code></a>
<!-- Modify DOM definition -->
</dt><dd>Its <a href=#concept-documenttype-elementtypes title=concept-DocumentType-elementTypes>element
types</a>, <a href=#concept-documenttype-generalentities title=concept-DocumentType-generalEntities>general
entities</a>, and <a href=#concept-documenttype-notations title=concept-DocumentType-notations>notations</a>.

</dd><dt><a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a>
</dt><dd>Its <a href=#concept-element-type-name title=concept-element-type-name>name</a> and <a href=#concept-elementtypedefinition-attributedefinitions title=concept-ElementTypeDefinition-attributeDefinitions>attribute
definitions</a>.<!-- XXX and content model -->

</dd><dt><a href=#AttributeDefinition><code>AttributeDefinition</code></a> </dt><dd>Its <a href=#concept-attribute-definition-name title=concept-attribute-definition-name>name</a>, <a href=#concept-attribute-definition-declared-type title=concept-attribute-definition-declared-type>declared type</a>,
<a href=#concept-attribute-definition-allowed-tokens title=concept-attribute-definition-allowed-tokens>allowed
tokens</a>, <a href=#concept-attribute-definition-default-type title=concept-attribute-definition-default-type>default type</a>,
and <a href=#concept-attribute-definition-default-value title=concept-attribute-definition-default-value>default
value</a>.

</dd><dt><a href=#entity><code>Entity</code></a>
<!-- Modify DOM3CORE definition -->
</dt><dd>Its <span title=concept-entity-name>name</span>, <a href=#concept-entity-publicid title=concept-entity-publicid>public ID</a>, <a href=#concept-entity-systemid title=concept-entity-systemid>system ID</a>, <a href=#concept-entity-notation-name title=concept-entity-notation-name>notation name</a>, and <a href=#concept-entity-replacement-text title=concept-entity-replacement-text>replacement text</a>.

</dd><dt><a href=#notation><code>Notation</code></a>
<!-- Modify DOM3CORE definition -->
</dt><dd>Its <span title=concept-notation-name>name</span>, <a href=#concept-notation-publicid title=concept-notation-publicid>public ID</a>, and <a href=#concept-notation-systemid title=concept-notation-systemid>system ID</a>.

</dd></dl>

<p>For the comparison of node sets, only the length and equality of
nodes with same <a href=#dom-node-nodename><code title=dom-Node-nodeName>nodeName</code></a> in the
set are significant.  The order of the nodes are not ignored for the
purpose of the comparison.  For the comparison of <a href=#concept-attribute-definition-allowed-tokens title=concept-attribute-definition-allowed-tokens>allowed
tokens</a>, the length of items and existence of the values in both
are taken into account.

</p><p>If at least one of two nodes compared by the <code title=dom-Node-compareDocumentPosition>compareDocumentPosition</code>
method (i.e. <var title="">reference</var> and <var title="">other</var>)
are <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a>,
<a href=#AttributeDefinition><code>AttributeDefinition</code></a>, <a href=#entity><code>Entity</code></a>, or
<a href=#notation><code>Notation</code></a> and they are different nodes, the following
rules are applied:

</p><ul>

<li>If both nodes are of these four node types and their <a href=#concept-owner title=concept-owner>owners</a> are the same node,

  <ul>

  <li>If <var title="">other</var>'s node type is less than <var title="">reference</var>'s node type, the method <em class=rfc2119>MUST</em> return the result of adding <code title=dom-Node-DOCUMENT_POSITION_PRECEDING>DOCUMENT_POSITION_PRECEDING</code>
  to <code title=dom-Node-DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC>DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC</code>.

  </li><li>Otherwise, if <var title="">other</var>'s node type is greater than
  <var title="">reference</var>'s node type, the method <em class=rfc2119>MUST</em> return the result of adding <code title=dom-Node-DOCUMENT_POSITION_FOLLOWING>DOCUMENT_POSITION_FOLLOWING</code>
  to <code title=dom-Node-DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC>DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC</code>.

  </li><li>Otherwise, if <var title="">other</var>'s <a href=#dom-node-nodename><code title=dom-Node-nodeName>nodeName</code></a> is less than <var title="">reference</var>'s <a href=#dom-node-nodename><code title=dom-Node-nodeName>nodeName</code></a> in code point order, the
  method <em class=rfc2119>MUST</em> return the resulf of adding <code title=dom-Node-DOCUMENT_POSITION_PRECEDING>DOCUMENT_POSITION_PRECEDING</code>
  to <code title=dom-Node-DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC>DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC</code>.

  </li><li>Otherwise, the method <em class=rfc2119>MUST</em> return the
  result of adding <code title=dom-Node-DOCUMENT_POSITION_FOLLOWING>DOCUMENT_POSITION_FOLLOWING</code>
  to <code title=dom-Node-DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC>DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC</code>.

  </li></ul>

</li><li>Otherwise, the <a href=#concept-owner title=concept-owner>owner</a> <em class=rfc2119>MUST</em> be considered as the <a href=#concept-tree-parent title=concept-tree-parent>parent</a> of the node for the purpose of
comparison.  The nodes of these four types <em class=rfc2119>MUST</em>
be considered as preceding any <a href=#concept-tree-child title=concept-tree-child>child</a> node of the <a href=#concept-owner title=concept-owner>owner</a>.

</li></ul>

<hr>

<p>A node of type <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a>,
<a href=#entity><code>Entity</code></a>, or <a href=#notation><code>Notation</code></a> has an associated <dfn id=concept-owner-document-type-definition title=concept-owner-document-type-definition>owner document type
definition</dfn>.  The <a href=#AttributeDefinition><code>AttributeDefinition</code></a> node has an
associated <dfn id=concept-owner-element-type-definition title=concept-owner-element-type-definition>owner
element type definition</dfn>.  Their values are <a href=#null>null</a>
unless otherwise specified.  When not ambiguous, they are simply
referred to as <dfn id=concept-owner title=concept-owner>owner</dfn> of the node.

</p><p>The <dfn id=dom-ownerdocumenttypedefinition title=dom-ownerDocumentTypeDefinition><code id=ownerDocumentTypeDefinition>ownerDocumentTypeDefinition</code></dfn>
attribute of the <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a>,
<a href=#entity><code>Entity</code></a>, and <a href=#notation><code>Notation</code></a> interfaces <em class=rfc2119>MUST</em> return the <a href=#concept-owner-document-type-definition title=concept-owner-document-type-definition>owner document type
definition</a> of the <a href=#context-object>context object</a>.  The <dfn id=dom-ownerelementtypedefinition title=dom-ownerElementTypeDefinition><code id=ownerElementTypeDefinition>ownerElementTypeDefinition</code></dfn>
attribute of the <a href=#AttributeDefinition><code>AttributeDefinition</code></a> interface <em class=rfc2119>MUST</em> return the <a href=#concept-owner-element-type-definition title=concept-owner-element-type-definition>owner element type
definition</a> of the <a href=#context-object>context object</a>.

</p><p>The <dfn id=dom-publicid title=dom-publicId><code id=publicId>publicId</code></dfn>
attribute and the <dfn id=dom-systemid title=dom-systemId><code id=systemId>systemId</code></dfn> attribute of the <a href=#entity><code>Entity</code></a>
and <a href=#notation><code>Notation</code></a> interfaces <em class=rfc2119>MUST</em>
return the <span title=concept-publicid>public ID</span> and <span title=concept-systemid>system ID</span> of the <a href=#context-object>context
object</a>, respectively.<!-- For DocumentType, defined in DOM -->.

</p><p>On setting, the <a href=#dom-publicid><code title=dom-publicId>publicId</code></a> attribute
and the <a href=#dom-systemid><code title=dom-systemId>systemId</code></a> attribute of the
<a href=#documenttype><code>DocumentType</code></a>, <a href=#entity><code>Entity</code></a>, and
<a href=#notation><code>Notation</code></a> interfaces <em class=rfc2119>MUST</em> set the
<span title=concept-publicid>public ID</span> and <span title=concept-systemid>system ID</span> of the <a href=#context-object>context
object</a>, respectively, to the new value.

</p><div class="note memo">
<p>In DOM Standard and DOM3 Core specifications, these attributes are
read-only.
</p></div>

<div class="note memo">
<p>Setting an invalid identifier to these attribute might make the
node unserializable in the XML syntax.
</p></div>

<hr>

<p>When a <a href=#namednodemap><code>NamedNodeMap</code></a> <a href=#concept-collection title=concept-collection>collection</a> represents <a href=#concept-documenttype-elementtypes title=concept-DocumentType-elementTypes>element types</a>, <a href=#concept-documenttype-generalentities title=concept-DocumentType-generalEntities>general entities</a>,
<a href=#concept-documenttype-notations title=concept-DocumentType-notations>notations</a>, or <a href=#concept-elementtypedefinition-attributedefinitions title=concept-ElementTypeDefinition-attributeDefinitions>attribute
definitions</a>, methods <code title=dom-NamedNodeMap-getNamedItemNS>getNamedItemNS</code>, <code title=dom-NamedNodeMap-setNamedItemNS>setNamedItemNS</code>, and <code title=dom-NamedNodeMap-removeNamedItemNS>removeNamedItemNS</code> of
the <a href=#namednodemap><code>NamedNodeMap</code></a> interface <cite class="bibref
normative">[<a href=#ref-DOM3CORE>DOM3CORE</a>]</cite> <em class=rfc2119>MUST</em> <a href=#throw>throw</a> a
"<code>NotSupportedError</code>" exception.

</p></div>

<div class=section id=section-document>
<h2 id=Document><span class=secno>4 </span>Documents</h2>

<p>Several factory methods are added to the <a href=#document-0><code>Document</code></a>
interface.

</p><pre class=idl id=section-documentxdoctype><code>partial interface <a href=#document-0>Document</a> {
  <a href=#documenttype>DocumentType</a> <a href=#dom-document-createdocumenttypedefinition title=dom-Document-createDocumentTypeDefinition>createDocumentTypeDefinition</a>(<span>DOMString</span> name);
  <a href=#ElementTypeDefinition>ElementTypeDefinition</a> <a href=#dom-document-createelementtypedefinition title=dom-Document-createElementTypeDefinition>createElementTypeDefinition</a>(<span>DOMString</span> name);
  <a href=#AttributeDefinition>AttributeDefinition</a> <a href=#dom-document-createattributedefinition title=dom-Document-createAttributeDefinition>createAttributeDefinition</a>(<span>DOMString</span> name);
  <a href=#entity>Entity</a> <a href=#dom-document-creategeneralentity title=dom-Document-createGeneralEntity>createGeneralEntity</a>(<span>DOMString</span> name);
  <a href=#notation>Notation</a> <a href=#dom-document-createnotation title=dom-Document-createNotation>createNotation</a>(<span>DOMString</span> name);
};</code></pre>

<div class="note memo">
  <p>Earlier versions of this specification called this WebIDL
  fragment as the <dfn id=DocumentXDoctype><code>DocumentXDoctype</code></dfn> interface.
</p></div>

<p>The <dfn id=dom-document-createdocumenttypedefinition title=dom-Document-createDocumentTypeDefinition><code id=createDocumentTypeDefinition>createDocumentTypeDefinition(<var>name</var>)</code></dfn>
method <em class=rfc2119>MUST</em> run these steps:

</p><ol>

  <li>If <var title="">name</var> does not match the <a href=#getAttributeDefinitionNode-name><code>Name</code></a>
  production, <a href=#throw>throw</a> an
  "<a href=#invalidcharactererror><code>InvalidCharacterError</code></a>" exception and terminate these
  steps.

  </li><li>Return a new <a href=#concept-doctype title=concept-doctype>doctype</a>, with
  <var title="">name</var> as its <a href=#concept-doctype-name title=concept-doctype-name>name</a> and with its <a href=#concept-node-document title=concept-node-document>node document</a> set to the
  <a href=#context-object>context object</a>.

</li></ol>

<p>The <dfn id=dom-document-createelementtypedefinition title=dom-Document-createElementTypeDefinition><code id=createDocumentTypeDefinition>createElementTypeDefinition(<var>name</var>)</code></dfn>
method <em class=rfc2119>MUST</em> run these steps:

</p><ol>

  <li>If <var title="">name</var> does not match the <a href=#getAttributeDefinitionNode-name><code>Name</code></a>
  production, <a href=#throw>throw</a> an
  "<a href=#invalidcharactererror><code>InvalidCharacterError</code></a>" exception and terminate these
  steps.

  </li><li>Return a new <a href=#concept-element-type title=concept-element-type>element
  type</a>, with <var title="">name</var> as its <a href=#concept-element-type-name title=concept-element-type-name>name</a> and with its <a href=#concept-node-document title=concept-node-document>node document</a> set to the
  <a href=#context-object>context object</a>.

</li></ol>

<p>The <dfn id=dom-document-createattributedefinition title=dom-Document-createAttributeDefinition><code id=createDocumentTypeDefinition>createAttributeDefinition(<var>name</var>)</code></dfn>
method <em class=rfc2119>MUST</em> run these steps:

</p><ol>

  <li>If <var title="">name</var> does not match the <a href=#getAttributeDefinitionNode-name><code>Name</code></a>
  production, <a href=#throw>throw</a> an
  "<a href=#invalidcharactererror><code>InvalidCharacterError</code></a>" exception and terminate these
  steps.

  </li><li>Return a new <a href=#concept-attribute-definition title=concept-attribute-definition>attribute
  definition</a>, with <var title="">name</var> as its <a href=#concept-attribute-definition-name title=concept-attribute-definition-name>name</a> and with its
  <a href=#concept-node-document title=concept-node-document>node document</a> set to the
  <a href=#context-object>context object</a>.

</li></ol>

<p>The <dfn id=dom-document-creategeneralentity title=dom-Document-createGeneralEntity><code id=createDocumentTypeDefinition>createGeneralEntity(<var>name</var>)</code></dfn>
method <em class=rfc2119>MUST</em> run these steps:

</p><ol>

  <li>If <var title="">name</var> does not match the <a href=#getAttributeDefinitionNode-name><code>Name</code></a>
  production, <a href=#throw>throw</a> an
  "<a href=#invalidcharactererror><code>InvalidCharacterError</code></a>" exception and terminate these
  steps.

  </li><li>Return a new <a href=#concept-general-entity title=concept-general-entity>general
  entity</a>, with <var title="">name</var> as its <span title=concept-entity-name>name</span> and with its <a href=#concept-node-document title=concept-node-document>node document</a> set to the
  <a href=#context-object>context object</a>.

</li></ol>

<p>The <dfn id=dom-document-createnotation title=dom-Document-createNotation><code id=createDocumentTypeDefinition>createNotation(<var>name</var>)</code></dfn>
method <em class=rfc2119>MUST</em> run these steps:

</p><ol>

  <li>If <var title="">name</var> does not match the <a href=#getAttributeDefinitionNode-name><code>Name</code></a>
  production, <a href=#throw>throw</a> an
  "<a href=#invalidcharactererror><code>InvalidCharacterError</code></a>" exception and terminate these
  steps.

  </li><li>Return a new <a href=#concept-notation title=concept-notation>notation</a>, with
  <var title="">name</var> as its <span title=concept-notation-name>name</span> and with its <a href=#concept-node-document title=concept-node-document>node document</a> set to the
  <a href=#context-object>context object</a>.

</li></ol>

<div class="note memo">
<p><a href=#getAttributeDefinitionNode-name><var>name</var></a> does not have to be a namespace qualified name.</p>
</div>

</div>


<div class=section id=section-documenttype>
<h2 id=document-types><span class=secno>5 </span>Document types</h2>

<p>Each <a href=#concept-doctype title=concept-doctype>doctype</a> has associated
unordered sets of nodes <dfn id=concept-documenttype-elementtypes title=concept-DocumentType-elementTypes>element types</dfn>, <dfn id=concept-documenttype-generalentities title=concept-DocumentType-generalEntities>general entities</dfn>, and
<dfn id=concept-documenttype-notations title=concept-DocumentType-notations>notations</dfn>.  Unless
otherwise specified, they <em class=rfc2119>MUST</em> be empty when
the <a href=#concept-doctype title=concept-doctype>doctype</a> is created.

</p><p>The set <a href=#concept-documenttype-elementtypes title=concept-DocumentType-elementTypes>element
types</a> can only contains <a href=#concept-element-type title=concept-element-type>element types</a>.

</p><p>The <dfn id=dom-documenttype-elementtypes title=dom-DocumentType-elementTypes><code id=elementTypes>elementTypes</code></dfn> attribute of the
<a href=#documenttype><code>DocumentType</code></a> interface <em class=rfc2119>MUST</em> return
an <a href=#namednodemap><code>NamedNodeMap</code></a> <a href=#concept-collection title=concept-collection>collection</a> containing the nodes in the
<a href=#concept-documenttype-elementtypes title=concept-DocumentType-elementTypes>element types</a> set
of the <a href=#context-object>context object</a>, sorted by their <a href=#dom-node-nodename><code title=dom-Node-nodeName>nodeName</code></a>'s code point.

</p><p>The <a href=#concept-documenttype-generalentities title=concept-DocumentType-generalEntities>general
entities</a> of the <a href=#concept-doctype title=concept-doctype>doctype</a> is
exposed by the <a href=#dom-documenttype-entities><code title=dom-DocumentType-entities>entities</code></a>
attribute of the <a href=#documenttype><code>DocumentType</code></a> interface <cite class="bibref normative">[<a href=#ref-DOM3CORE>DOM3CORE</a>]</cite>.  The <dfn id=dom-documenttype-generalentities title=dom-DocumentType-generalEntities><code id=generalEntities>generalEntities</code></dfn> attribute of the
<a href=#documenttype><code>DocumentType</code></a> interface <em class=rfc2119>MUST</em> return
the same object as the <a href=#dom-documenttype-entities><code title=dom-DocumentType-entities>entities</code></a> attribute.  The nodes
in the <a href=#dom-documenttype-entities><code title=dom-DocumentType-entities>entities</code></a> <a href=#concept-collection title=concept-collection>collection</a> <em class=rfc2119>MUST</em>
be sorted by their <a href=#dom-node-nodename><code title=dom-Node-nodeName>nodeName</code></a>'s
code point.

</p><p>The <a href=#concept-documenttype-notations title=concept-DocumentType-notations>notations</a> of
the <a href=#concept-doctype title=concept-doctype>doctype</a> is exposed by the <a href=#dom-documenttype-notations><code title=dom-DocumentType-notations>notations</code></a> attribute of the
<a href=#documenttype><code>DocumentType</code></a> interface <cite class="bibref normative">[<a href=#ref-DOM3CORE>DOM3CORE</a>]</cite>.  The nodes in the <a href=#dom-documenttype-notations><code title=dom-DocumentType-notations>notations</code></a> <a href=#concept-collection title=concept-collection>collection</a> <em class=rfc2119>MUST</em>
be sorted by their <a href=#dom-node-nodename><code title=dom-Node-nodeName>nodeName</code></a>'s
code point.

</p><div class=ed>
<p>Need to merge with <code>manakai-allow-doctype-children</code>
configuration parameter spec...

</p><p>A <a href=#DocumentType><code>DocumentType</code></a> interface 
<em class=rfc2119>MAY</em> contain zero or more
<code>ProcessingInstruction</code> nodes in the <code>NodeList</code> object 
contained in the <code>childNodes</code> attribute of the 
<a href=#DocumentType><code>DocumentType</code></a> node.</p>

<p>If the <a href=#DocumentType><code>DocumentType</code></a> node is created
during the process to create a <abbr>DOM</abbr> from an <abbr>XML</abbr>
document, the <code>NodeList</code> object in the <code>childNodes</code> 
object <em class=rfc2119>MUST</em> contains the 
<code>ProcessingInstruction</code> nodes representing the processing 
instructions in the document type definition of the document processed
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite> by the <abbr>XML</abbr> processor.

</p><p>If a <a href=#DocumentType><code>DocumentType</code></a> node is created
from a
<a href=http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#infoitem.doctype>document
type declaration information item</a>
<cite class="bibref normative">[<a href=#ref-INFOSET>INFOSET</a>]</cite>,
the <code>NodeList</code> object in the <code>childNodes</code> attribute
of the node <em class=rfc2119>MUST</em> contain the
<code>ProcessingInstruction</code> nodes created from any
<a href=http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#infoitem.pi>processing
instruction information items</a> in the list in the [children] property of the
<a href=http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#infoitem.doctype>document
type declaration item</a> in the same order.</p>

<p>If a <a href=#DocumentType><code>DocumentType</code></a> node is mapped to
a document type declaration information item, the list in the [children] 
property <em class=rfc2119>MUST</em> contain the processng instruction
information items created from the <code>ProcessingInstruction</code> nodes
in the <code>NodeList</code> object in the <code>childNodes</code> attribute
of the <a href=#DocumentType><code>DocumentType</code></a> node.</p>
</div>

<pre class=idl id=section-documenttypedefinition><code>partial interface <a href=#documenttype>DocumentType</a> {
  [TreatNullAs=EmptyString] attribute <span>DOMString</span> <a href=#dom-publicid title=dom-publicId>publicId</a>;
  [TreatNullAs=EmptyString] attribute <span>DOMString</span> <a href=#dom-systemid title=dom-systemId>systemId</a>;
  attribute <span>DOMString</span>? <a href=#dom-documenttype-declarationbaseuri title=dom-DocumentType-declarationBaseURI>declarationBaseURI</a>;
  attribute <span>DOMString</span>? <a href=#dom-documenttype-manakaideclarationbaseuri title=dom-DocumentType-manakaiDeclarationBaseURI>manakaiDeclarationBaseURI</a>;

  readonly attribute <a href=#namednodemap>NamedNodeMap</a> <a href=#dom-documenttype-elementtypes title=dom-DocumentType-elementTypes>elementTypes</a>;
  readonly attribute <a href=#namednodemap>NamedNodeMap</a> <a href=#dom-documenttype-generalentities title=dom-DocumentType-generalEntities>generalEntities</a>;

  <a href=#ElementTypeDefinition>ElementTypeDefinition</a> <a href=#getElementTypeDefinitionNode>getElementTypeDefinitionNode</a>
    (in DOMString <a href=#getElementTypeDefinitionNode-name><var>name</var></a>);
  <a href=#Entity>Entity</a> <a href=#getGeneralEntityNode>getGeneralEntityNode</a>
    (in DOMString <a href=#getGeneralEntityNode-name><var>name</var></a>);
  <a href=#Notation>Notation</a> <a href=#getNotationNode>getNotationNode</a>
    (in DOMString <a href=#getNotationNode-name><var>name</var></a>);

  <a href=#ElementTypeDefinition>ElementTypeDefinition</a>? <a href=#dom-documenttype-setelementtypedefinitionnode title=dom-DocumentType-setElementTypeDefinitionNode>setElementTypeDefinitionNode</a>(<a href=#ElementTypeDefinition>ElementTypeDefinition</a> node);
  <a href=#entity>Entity</a>? <a href=#dom-documenttype-setgeneralentitynode title=dom-DocumentType-setGeneralEntityNode>setGeneralEntityNode</a>(<a href=#entity>Entity</a> node);
  <a href=#notation>Notation</a>? <a href=#dom-documenttype-setnotationnode title=dom-DocumentType-setNotationNode>setNotationNode</a>(<a href=#notation>Notation</a> node);
  <a href=#ElementTypeDefinition>ElementTypeDefinition</a> <a href=#dom-documenttype-removeelementtypedefinitionnode title=dom-DocumentType-removeElementTypeDefinitionNode>removeElementTypeDefinitionNode</a>(<a href=#ElementTypeDefinition>ElementTypeDefinition</a> node);
  <a href=#entity>Entity</a> <a href=#dom-documenttype-removegeneralentitynode title=dom-DocumentType-removeGeneralEntityNode>removeGeneralEntityNode</a>(<a href=#entity>Entity</a> node);
  <a href=#notation>Notation</a> <a href=#dom-documenttype-removenotationnode title=dom-DocumentType-removeNotationNode>removeNotationNode</a>(<a href=#notation>Notation</a> node);
};</code></pre>

<div class="note memo">

  <p>Earlier versions of this specification named this WebIDL fragment
  as the <dfn id=DocumentTypeDefinition><code>DocumentTypeDefinition</code></dfn>
  interface.

</p></div>

<div class=ed>
  <p>If the <a href=#documenttype><code>DocumentType</code></a> node is created during the process
  to create a <abbr>DOM</abbr> from an <abbr>XML</abbr> document, the following
  requirements are applied:  The <a href=#namednodemap><code>NamedNodeMap</code></a> object in the
  <a href=#elementTypes><code>elementType</code></a> attribute 
  <em class=rfc2119>MUST</em> be so transformed that the object contains
  the <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a> nodes for the element types
  whose name is presented as the <a href=#getAttributeDefinitionNode-name><code>Name</code></a> of the element type or
  attribute definition list declarations processed
  <cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
  <a href=#ref-XML11>XML11</a>]</cite> by the <abbr>XML</abbr>
  processor.  If there are more than one element type declarations for an
  element type, then the declarations other than the first one 
  <em class=rfc2119>MUST</em> be ignored for the purpose of constructing the
  <a href=#namednodemap><code>NamedNodeMap</code></a> object.</p>

<p>All entities declared in the document type definition
contained in or referenced from the document entity
might not be exposed through this collection, depending
on the information provided by the XML processor for
the DOM implementation.  In particular, it might not
contain any entity if entity references are expanded
at the parse time.  An implementation [['''MUST NOT''']]
expose an [CODE(DOMi)@en[[[Entity]]]] node whose [CODE(DOMa)@en[[[nodeName]]]]
is equal to the name of one of five predefined general entities in
XML through the collection as the result of parsing of an XML
document that has no error.  Duplicate entity declarations are also discarded.

</p><p>The attribute [['''MUST''']] return the [CODE(DOMi)@en[[[NamedNodeMap]]]]
object that contains all the [CODE(DOMi)@en[[[Entity]]]] nodes
representing general entities belong to the node.

</p><p>If the [CODE(DOMi)@en[[[DocumentTypeDefinition]]]] node is
created from an XML document, duplicate notation declarations, if any, in DTD 
[['''MUST NOT''']] result in a node in the [CODE(DOMi)@en[[[NamedNodeMap]]]]
object and only the first declaration [['''MUST''']] be
made available as a [CODE(DOMi)@en[[[Notation]]]] node.

</p><p>;; This definition is based on one for the 
[CODE(DOMa)@en[[[notations]]]] attribute of the
[CODE(DOMi)@en[[[DocumentType]]]] interface in DOM XML module.
Since duplication is violation to the Validity Constraint,
XML parsers might vary on how notations are notified to
the application.  In particular, [CODE(InfoProp)@en[[[notations]]]]
property of the document information item in XML Information Set
is so defined that in case ''any'' notation is declared for 
multiple times then the property has no value.

</p><p>The attribute [['''MUST''']] return the [CODE(DOMi)@en[[[NamedNodeMap]]]]
object that contains all the [CODE(DOMi)@en[[[Notation]]]] nodes
representing notations belong to the node.
</p></div>

<dl>
<dt><dfn class=dom-method id=getElementTypeDefinitionNode><code>getElementTypeDefinitionNode</code></dfn>,
method</dt>
  <dd><p>Returns the
  <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a> node
  with the specified name.</p>

  <p>The
  <dfn class=dom-param id=getElementTypeDefinitionNode-name><var>name</var></dfn>
  parameter is the name of the element type.</p>

  <p>When invoked, the method <em class=rfc2119>MUST</em> return the 
  <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a> node,
  whose <a href=#nodeName><code>nodeName</code></a> is equal to
  <a href=#getElementTypeDefinitionNode-name><var>name</var></a>, in the
  <a href=#namednodemap><code>NamedNodeMap</code></a> object in the
  <a href=#elementTypes><code>elementTypes</code></a> attribute of the
  node.  If there is no such node, it <em class=rfc2119>MUST</em> return
  <a href=#null><code>null</code></a>.</p></dd>
<dt><dfn class=dom-method id=getGeneralEntityNode><code>getGeneralEntityNode</code></dfn>,
method</dt>
  <dd><p>Returns the <a href=#Entity><code>Entity</code></a> node
  with the specified name.</p>

  <p>The
  <dfn class=dom-param id=getGeneralEntityNode-name><var>name</var></dfn>
  parameter is the name of the general entity.</p>

  <p>When invoked, the method <em class=rfc2119>MUST</em> return the 
  <a href=#Entity><code>Entity</code></a> node,
  whose <a href=#nodeName><code>nodeName</code></a> is equal to
  <a href=#getGeneralEntityNode-name><var>name</var></a>, in the
  <a href=#namednodemap><code>NamedNodeMap</code></a> object in the
  <a href=#entities><code>entities</code></a> attribute of the
  node.  If there is no such node, it <em class=rfc2119>MUST</em> return
  <a href=#null><code>null</code></a>.</p></dd>
<dt><dfn class=dom-method id=getNotationNode><code>getNotationNode</code></dfn>,
method</dt>
  <dd><p>Returns the <a href=#Notation><code>Notation</code></a> node
  with the specified name.</p>

  <p>The
  <dfn class=dom-param id=getNotationNode-name><var>name</var></dfn>
  parameter is the name of the notation.</p>

  <p>When invoked, the method <em class=rfc2119>MUST</em> return the 
  <a href=#Notation><code>Notation</code></a> node,
  whose <a href=#nodeName><code>nodeName</code></a> is equal to
  <a href=#getNotationNode-name><var>name</var></a>, in the
  <a href=#namednodemap><code>NamedNodeMap</code></a> object in the
  <a href=#notations><code>notations</code></a> attribute of the
  node.  If there is no such node, it <em class=rfc2119>MUST</em> return
  <a href=#null><code>null</code></a>.</p></dd>

<dt><dfn class=dom-method id=dom-documenttype-setelementtypedefinitionnode title=dom-DocumentType-setElementTypeDefinitionNode><code id=setElementTypeDefinitionNode>setElementTypeDefinitionNode</code></dfn>,
method</dt>

<dd>The <a href=#dom-documenttype-setelementtypedefinitionnode><code title=dom-DocumentType-setElementTypeDefinitionNode>setElementTypeDefinitionNode(<var title="">node</var>)</code></a> method <em class=rfc2119>MUST</em> return the
result of <a href=#concept-set-node title=concept-set-node>setting</a> <var title="">node</var> to the <a href=#context-object>context object</a>'s <a href=#concept-documenttype-elementtypes title=concept-DocumentType-elementTypes>element types</a>.

</dd><dt><dfn class=dom-method id=dom-documenttype-setgeneralentitynode title=dom-DocumentType-setGeneralEntityNode><code id=setGeneralEntityNode>setGeneralEntityNode</code></dfn>, method</dt>

<dd>The <a href=#dom-documenttype-setgeneralentitynode><code title=dom-DocumentType-setGeneralEntityNode>setGeneralEntityNode(<var title="">node</var>)</code></a> method <em class=rfc2119>MUST</em> return the
result of <a href=#concept-set-node title=concept-set-node>setting</a> <var title="">node</var> to the <a href=#context-object>context object</a>'s <a href=#concept-documenttype-generalentities title=concept-DocumentType-generalEntities>general entities</a>.

</dd><dt><dfn class=dom-method id=dom-documenttype-setnotationnode title=dom-DocumentType-setNotationNode><code id=setNotationNode>setNotationNode</code></dfn>, method

</dt><dd>The <a href=#dom-documenttype-setnotationnode><code title=dom-DocumentType-setNotationNode>setNotationNode(<var title="">node</var>)</code></a> method <em class=rfc2119>MUST</em> return the
result of <a href=#concept-set-node title=concept-set-node>setting</a> <var title="">node</var> to the <a href=#context-object>context object</a>'s <a href=#concept-documenttype-notations title=concept-DocumentType-notations>notations</a>.

</dd><dt><dfn class=dom-method id=dom-documenttype-removeelementtypedefinitionnode title=dom-DocumentType-removeElementTypeDefinitionNode><code>removeElementTypeDefinitionNode</code></dfn>, method

</dt><dd>The <a href=#dom-documenttype-removeelementtypedefinitionnode><code title=dom-DocumentType-removeElementTypeDefinitionNode>removeElementTypeDefinitionNode(<var title="">node</var>)</code></a> method <em class=rfc2119>MUST</em> return the
result of <a href=#concept-remove-node title=concept-remove-node>removing</a> <var title="">node</var> from the <a href=#context-object>context object</a>'s <a href=#concept-documenttype-elementtypes title=concept-DocumentType-elementTypes>element types</a>.

</dd><dt><dfn class=dom-method id=dom-documenttype-removegeneralentitynode title=dom-DocumentType-removeGeneralEntityNode><code>removeGeneralEntityNode</code></dfn>, method

</dt><dd>The <a href=#dom-documenttype-removegeneralentitynode><code title=dom-DocumentType-removeGeneralEntityNode>removeGeneralEntityNode(<var title="">node</var>)</code></a> method <em class=rfc2119>MUST</em> return the
result of <a href=#concept-remove-node title=concept-remove-node>removing</a> <var title="">node</var> from the <a href=#context-object>context object</a>'s <a href=#concept-documenttype-generalentities title=concept-DocumentType-generalEntities>general entities</a>.

</dd><dt><dfn class=dom-method id=dom-documenttype-removenotationnode title=dom-DocumentType-removeNotationNode><code>removeNotationNode</code></dfn>, method

</dt><dd>The <a href=#dom-documenttype-removenotationnode><code title=dom-DocumentType-removeNotationNode>removeNotationNode(<var title="">node</var>)</code></a> method <em class=rfc2119>MUST</em> return the
result of <a href=#concept-remove-node title=concept-remove-node>removing</a> <var title="">node</var> from the <a href=#context-object>context object</a>'s <a href=#concept-documenttype-notations title=concept-DocumentType-notations>notations</a>.

</dd></dl>

<p>To <dfn id=concept-remove-node title=concept-remove-node>remove</dfn> a node <var title="">node</var> from the set of nodes <var title="">set</var><!--
associated to the node <var title>owner</var>-->, run these steps:

</p><ol>

  <li>If <var title="">set</var> does not contain <var title="">node</var>,
  <a href=#throw>throw</a> an "<a href=#notfounderror><code>NotFoundError</code></a>" exception and
  abort these steps.

  </li><li>Remove <var title="">node</var> from <var title="">set</var>.

  </li><li>Set the <a href=#concept-owner title=concept-owner>owner</a> of
  <var title="">node</var> to <a href=#null>null</a>.

  </li><li>Return <var title="">node</var>.
</li></ol>

<p>To <dfn id=concept-set-node title=concept-set-node>set</dfn> a node <var title="">node</var> to the set of nodes <var title="">set</var> associated
to the node <var title="">owner</var>, run these steps:

</p><ol>

<li>If the <a href=#concept-owner title=concept-owner>owner</a> of <var title="">node</var> is not <a href=#null>null</a> and is not equal to <var title="">owner</var>, <a href=#throw>throw</a> a
"<a href=#hierarchyrequesterror><code>HierarchyRequestError</code></a>" and abort these steps.

</li><li><a href=#concept-node-adopt title=concept-node-adopt>Adopt</a> <var title="">node</var>
into the <a href=#concept-node-document title=concept-node-document>node document</a> of
<var title="">owner</var>.

</li><li>Let <var title="">oldNode</var> be <a href=#null>null</a>.

</li><li>If there is a node whose <a href=#dom-node-nodename><code title=dom-Node-nodeName>nodeName</code></a> is equal to <var title="">node</var>'s <a href=#dom-node-nodename><code title=dom-Node-nodeName>nodeName</code></a> in
<var title="">set</var>, let <var title="">oldNode</var> be the node and
<a href=#concept-remove-node title=concept-remove-node>remove</a> <var title="">oldNode</var>
from <var title="">set</var>.

</li><li>Add <var title="">node</var> to <var title="">set</var>.

</li><li>Set the <a href=#concept-owner title=concept-owner>owner</a> of <var title="">node</var> to <var title="">owner</var>.

</li><li>Return <var title="">oldNode</var>.

</li></ol>

</div><!-- section -->

<div class=section id=section-elementtypedefinition>
<h2 id=element-types><span class=secno>6 </span>Element types</h2>

<p>The <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a> objects are simply known as
<dfn id=concept-element-type title=concept-element-type>element types</dfn>.  It represents
the definition of the element, identified by the <dfn id=concept-element-type-name title=concept-element-type-name>name.

</dfn></p><div class="note memo">
<p>Although the <a href=#concept-element-type title=concept-element-type>element type</a>
is corresponding to the <code>ELEMENT</code> declaration in the XML
DTD, the <a href=#concept-element-type title=concept-element-type>element type</a> does not
directly represent the <code>ELEMENT</code> declaration.
</p></div>

<pre class=idl><code>interface <dfn id=ElementTypeDefinition>ElementTypeDefinition</dfn> : <a href=#node>Node</a> {
  readonly attribute <a href=#documenttype>DocumentType</a>? <a href=#dom-ownerdocumenttypedefinition title=dom-ownerDocumentTypeDefinition>ownerDocumentTypeDefinition</a>;

  readonly attribute <a href=#namednodemap>NamedNodeMap</a> <a href=#dom-elementtypedefinition-attributedefinitions title=dom-ElementTypeDefinition-attributeDefinitions>attributeDefinitions</a>;
  <a href=#AttributeDefinition>AttributeDefinition</a>? <span title=dom-ElementTypeDefinition-getAttributeDefinitionNode>getAttributeDefinitionNode</span>(<span>DOMString</span> name);
  <a href=#AttributeDefinition>AttributeDefinition</a>? <a href=#dom-elementtypedefinition-setattributedefinitionnode title=dom-ElementTypeDefinition-setAttributeDefinitionNode>setAttributeDefinitionNode</a>(<a href=#AttributeDefinition>AttributeDefinition</a> node);
  <a href=#AttributeDefinition>AttributeDefinition</a> <a href=#dom-elementtypedefinition-removeattributedefinitionnode title=dom-ElementTypeDefinition-removeAttributeDefinitionNode>removeAttributeDefinitionNode</a>(<a href=#AttributeDefinition>AttributeDefinition</a> node);
};</code></pre>

<p>Each <a href=#concept-element-type title=concept-element-type>element type</a> has an
associated unordered set of nodes <dfn id=concept-elementtypedefinition-attributedefinitions title=concept-elementTypeDefinition-attributeDefinitions>attribute
definitions</dfn>.  Unless otherwise specified, it <em class=rfc2119>MUST</em> be empty when the <a href=#concept-element-type title=concept-element-type>element type</a> is created.  The set
<a href=#concept-elementtypedefinition-attributedefinitions title=concept-ElementTypeDefinition-attributeDefinitions>attribute
definitions</a> can only contains <a href=#concept-attribute-definition title=concept-attribute-definition>attribute definition</a>.

</p><p>The <dfn id=dom-elementtypedefinition-attributedefinitions title=dom-ElementTypeDefinition-attributeDefinitions><code id=attributeDefinitions>attributeDefinitions</code></dfn> attribute of
the <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a> interface <em class=rfc2119>MUST</em> return an <a href=#namednodemap><code>NamedNodeMap</code></a> <a href=#concept-collection title=concept-collection>collection</a> containing the nodes in the
<a href=#concept-elementtypedefinition-attributedefinitions title=concept-ElementTypeDefinition-attributeDefinitions>attribute
definitions</a> set of the <a href=#context-object>context object</a>, sorted by
their <a href=#dom-node-nodename><code title=dom-Node-nodeName>nodeName</code></a>'s code point.

</p><div class=ed>

<p>Even if there are more than one element type declarations for an
element type in <abbr>DTD</abbr>, the result <abbr>DOM</abbr> will
contain only an <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a>
node for that element type.  In addition, if there are attribute
definition declarations for an element type, even when there is no
element type declaration for that element type, the <abbr>DOM</abbr>
will contain an <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a>
node for that element type.</p>

  <p>If the
  <a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a> node
  is created during the process to create a <abbr>DOM</abbr> from an
  <abbr>XML</abbr> document, the following requirements are applied:  The
  <a href=#namednodemap><code>NamedNodeMap</code></a> object in the 
  <a href=#attributeDefinitions><code>attributeDefinitions</code></a>
  attribute <em class=rfc2119>MUST</em> be so transformed that the object
  contains the
  <a href=#AttributeDefinition><code>AttributeDefinition</code></a> node
  corresponding to the attribute definitions in the attribute definition
  list declarations processed
  <cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
  <a href=#ref-XML11>XML11</a>]</cite> by the <abbr>XML</abbr> processor and
  associated to the element type represented by the node.  If there are more
  than one attribute definitions for an attribute, then the definitions other
  than the first one <em class=rfc2119>MUST</em> be ignored for the purpose
  of constructing the <a href=#namednodemap><code>NamedNodeMap</code></a> object.</p>
</div>

<dl>
<dt><dfn class=dom-method id=getAttributeDefinitionNode><code>getAttributeDefinitionNode</code></dfn>,
method</dt>
  <dd><p>Return the
  <a href=#AttributeDefinition><code>AttributeDefinition</code></a> node
  with the specified name.</p>

  <p>The
  <dfn class=dom-param id=getAttributeDefinitionNode-name><var>name</var></dfn>
  parameter is the name of the attribute.</p>

  <p>When invoked, the method <em class=rfc2119>MUST</em> return the
  <a href=#AttributeDefinition><code>AttributeDefinition</code></a> node,
  whose <a href=#nodeName><code>nodeName</code></a> attribute value is
  equal to <a href=#getAttributeDefinitionNode-name><var>name</var></a>,
  in the <a href=#namednodemap><code>NamedNodeMap</code></a> in the 
  <a href=#attributeDefinitions><code>attributeDefinitions</code></a>
  attribute of the node.  If there is no such node, it 
  <em class=rfc2119>MUST</em> return <a href=#null><code>null</code></a>.</p></dd>
</dl>

<p>The <dfn id=dom-elementtypedefinition-setattributedefinitionnode title=dom-ElementTypeDefinition-setAttributeDefinitionNode><code id=setAttributeDefinitionNode>setAttributeDefinitionNode(<var title="">node</var>)</code></dfn> method of the
<a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a> object <em class=rfc2119>MUST</em>
return the result of <a href=#concept-set-node title=concept-set-node>setting</a> <var title="">node</var> to the <a href=#context-object>context object</a>'s <a href=#concept-elementtypedefinition-attributedefinitions title=concept-ElementTypeDefinition-attributeDefinitions>attribute
definitions</a>.

</p><p>The <dfn id=dom-elementtypedefinition-removeattributedefinitionnode title=dom-ElementTypeDefinition-removeAttributeDefinitionNode><code>removeAttributeDefinitionNode(<var title="">node</var>)</code></dfn> method of the
<a href=#ElementTypeDefinition><code>ElementTypeDefinition</code></a> object <em class=rfc2119>MUST</em>
return the result of <a href=#concept-remove-node title=concept-remove-node>removing</a>
<var title="">node</var> from the <a href=#context-object>context object</a>'s <a href=#concept-elementtypedefinition-attributedefinitions title=concept-ElementTypeDefinition-attributeDefinitions>attribute
definitions</a>.

</p><div class=ed>
<p>A future version of the specification might define a set of attributes
and methods for representing and accessing to the content model of the 
element type.</p>

<pre class=idl><code>partial interface ElementTypeDefinition {
  attribute DOMString? contentModelText;
};</code></pre>
</div>

</div><!-- section -->

<div class=section id=section-attributedefinition>
<h2 id=attribute-definitions><span class=secno>7 </span>Attribute definitions</h2>

<p>The nodes of type <a href=#ATTRIBUTE_DEFINITION_NODE><code>ATTRIBUTE_DEFINITION_NODE</code></a>
represents an <dfn id=concept-attribute-definition title=concept-attribute-definition>attribute
definition</dfn>.  Such a node <em class=rfc2119>MUST</em> implement
the <a href=#AttributeDefinition><code>AttributeDefinition</code></a>
interface, which extends the <a href=#Node><code>Node</code></a>
interface.</p>

<p>Each <a href=#concept-attribute-definition title=concept-attribute-definition>attribute
definition</a> has an associated <dfn id=concept-attribute-definition-name title=concept-attribute-definition-name>name</dfn>.

</p><p>Each <a href=#concept-attribute-definition title=concept-attribute-definition>attribute
definition</a> has associated <dfn id=concept-attribute-definition-declared-type title=concept-attribute-definition-declared-type>declared type</dfn>,
<dfn id=concept-attribute-definition-allowed-tokens title=concept-attribute-definition-allowed-tokens>allowed
tokens</dfn>, <dfn id=concept-attribute-definition-default-type title=concept-attribute-definition-default-type>default type</dfn>,
and <dfn id=concept-attribute-definition-default-value title=concept-attribute-definition-default-value>default
value</dfn>.  Unless otherwise specified, they are initialized to
their default values when the <a href=#concept-attribute-definition title=concept-attribute-definition>attribute definition</a> is
created.  Their default values are <code title=dom-AttributeDefinition-NO_TYPE_ATTR>NO_TYPE_ATTR</code>, the
empty list, <code title=dom-AttributeDefinition-UNKNOWN_DEFAULT>UNKNOWN_DEFAULT</code>,
and the empty string, respectively.

</p><p>An attribute definition represents a definition of the attribute 
associated to an element type.  It is corresponding to the attribute definition
in the attribute list declaration in <abbr>DTD</abbr>.  However, an
<a href=#AttributeDefinition><code>AttributeDefinition</code></a> node does 
not represent the attribute definition in <abbr>DTD</abbr> itself.  Even if 
there are more than one attribute definitions for an attribute of an element 
type in <abbr>DTD</abbr>, the result <abbr>DOM</abbr> will contain only an
<a href=#AttributeDefinition><code>AttributeDefinition</code></a> node for 
that attribute.</p>

<pre class=idl><code>interface <dfn id=AttributeDefinition>AttributeDefinition</dfn> : <a href=#Node>Node</a> {
  <span class=comment>// <dfn id=DefaultValueType>DefaultValueType</dfn>
  const unsigned short <a href=#UNKNOWN_DEFAULT>UNKNOWN_DEFAULT</a> = 0;
  const unsigned short <a href=#FIXED_DEFAULT>FIXED_DEFAULT</a> = 1;
  const unsigned short <a href=#REQUIRED_DEFAULT>REQUIRED_DEFAULT</a> = 2;
  const unsigned short <a href=#IMPLIED_DEFAULT>IMPLIED_DEFAULT</a> = 3;
  const unsigned short <a href=#EXPLICIT_DEFAULT>EXPLICIT_DEFAULT</a> = 4;

  readonly attribute <a href=#ElementTypeDefinition>ElementTypeDefinition</a>? <a href=#dom-ownerelementtypedefinition title=dom-ownerElementTypeDefinition>ownerElementTypeDefinition</a>;
  attribute unsigned short <a href=#declaredType>declaredType</a>;
  attribute <span>DOMString</span>[] <a href=#allowedTokens>allowedTokens</a>;
  attribute unsigned short <a href=#defaultType>defaultType</a>;
};

[NoInterfaceObject]
interface <dfn id=attrdeclaredvaluetype>AttrDeclaredValueType</dfn> {
  <span class=comment>// <dfn id=DeclaredValueType>DeclaredValueType</dfn>
  const unsigned short <a href=#NO_TYPE_ATTR>NO_TYPE_ATTR</a> = 0;
  const unsigned short <a href=#CDATA_ATTR>CDATA_ATTR</a> = 1;
  const unsigned short <a href=#ID_ATTR>ID_ATTR</a> = 2;
  const unsigned short <a href=#IDREF_ATTR>IDREF_ATTR</a> = 3;
  const unsigned short <a href=#IDREFS_ATTR>IDREFS_ATTR</a> = 4;
  const unsigned short <a href=#ENTITY_ATTR>ENTITY_ATTR</a> = 5;
  const unsigned short <a href=#ENTITIES_ATTR>ENTITIES_ATTR</a> = 6;
  const unsigned short <a href=#NMTOKEN_ATTR>NMTOKEN_ATTR</a> = 7;
  const unsigned short <a href=#NMTOKENS_ATTR>NMTOKENS_ATTR</a> = 8;
  const unsigned short <a href=#NOTATION_ATTR>NOTATION_ATTR</a> = 9;
  const unsigned short <a href=#ENUMERATION_ATTR>ENUMERATION_ATTR</a> = 10;
  const unsigned short <a href=#UNKNOWN_ATTR>UNKNOWN_ATTR</a> = 11;
};
<a href=#AttributeDefinition>AttributeDefinition</a> implements <a href=#attrdeclaredvaluetype>AttrDeclaredValueType</a>;
<a href=#attr>Attr</a> implements <a href=#attrdeclaredvaluetype>AttrDeclaredValueType</a>;
</span></span></code></pre>

<dl>
<dt><dfn class=dom-attr id=declaredType><code>declaredType</code></dfn> of type
<code>unsigned short</code></dt>
  <dd><p>The declared type
  <cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
  <a href=#ref-XML11>XML11</a>]</cite> of the attribute.  It is expected that
  this attribute contains a value from the definition group
  <a href=#DeclaredValueType><code>DeclaredValueType</code></a>.</p>

  <p>On getting, the attribute <em class=rfc2119>MUST</em> return the
  value associated to this attribute.</p>

  <p>On setting, it <em class=rfc2119>MUST</em> set the specified
  value as the value associated to this attribute.</p>

  <p>If the <a href=#AttributeDefinition><code>AttributeDefinition</code></a> node is created during the process
  to create a <abbr>DOM</abbr> from an <abbr>XML</abbr> document, an
  appropriate value from the
  <a href=#DeclaredValueType><code>DeclaredValueType</code></a> constant
  group <em class=rfc2119>MUST</em> be set to the attribute.</p>

  <!-- DeclaredValueType -->
<p>The definition group 
<dfn id=DeclaredValueType><code>DeclaredValueType</code></dfn> contains
integers indicating the declared type of attributes.  The definition
group contains the following constants:</p>

<table>
<thead>
<tr><th scope=col>Name</th><th scope=col>Value</th><th scope=col>Description</th></tr>
</thead>
<tbody>
<tr>
<th scope=row><dfn class=dom-const id=NO_TYPE_ATTR><code>NO_TYPE_ATTR</code>
</dfn></th><td><code>0</code></td><td><a href=http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#intro.null>No
value</a>
<cite class="bibref normative">[<a href=#ref-INFOSET>INFOSET</a>]</cite>.</td></tr>
<tr>
<th scope=row><dfn class=dom-const id=CDATA_ATTR><code>CDATA_ATTR</code>
</dfn></th><td><code>1</code></td><td><code>CDATA</code>
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
<tr>
<th scope=row><dfn class=dom-const id=ID_ATTR><code>ID_ATTR</code>
</dfn></th><td><code>2</code></td><td><code>ID</code>
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
<tr>
<th scope=row><dfn class=dom-const id=IDREF_ATTR><code>IDREF_ATTR</code>
</dfn></th><td><code>3</code></td><td><code>IDREF</code>
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
<tr>
<th scope=row><dfn class=dom-const id=IDREFS_ATTR><code>IDREFS_ATTR</code>
</dfn></th><td><code>4</code></td><td><code>IDREFS</code>
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
<tr>
<th scope=row><dfn class=dom-const id=ENTITY_ATTR><code>ENTITY_ATTR</code>
</dfn></th><td><code>5</code></td><td><a href=#entity><code>ENTITY</code></a>
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
<tr>
<th scope=row><dfn class=dom-const id=ENTITIES_ATTR><code>ENTITIES_ATTR</code>
</dfn></th><td><code>6</code></td><td><code>ENTITIES</code>
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
<tr>
<th scope=row><dfn class=dom-const id=NMTOKEN_ATTR><code>NMTOKEN_ATTR</code>
</dfn></th><td><code>7</code></td><td><code>NMTOKEN</code>
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
<tr>
<th scope=row><dfn class=dom-const id=NMTOKENS_ATTR><code>NMTOKENS_ATTR</code>
</dfn></th><td><code>8</code></td><td><code>NMTOKENS</code>
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
<tr>
<th scope=row><dfn class=dom-const id=NOTATION_ATTR><code>NOTATION_ATTR</code>
</dfn></th><td><code>9</code></td><td><a href=#notation><code>NOTATION</code></a>
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
<tr>
<th scope=row><dfn class=dom-const id=ENUMERATION_ATTR><code>ENUMERATION_ATTR</code>
</dfn></th><td><code>10</code></td><td>Enumeration
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
<tr>
<th scope=row><dfn class=dom-const id=UNKNOWN_ATTR><code>UNKNOWN_ATTR</code>
</dfn></th><td><code>11</code></td><td><a href=http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#intro.null>Unknown</a>,
because no declaration for the attribute has been read but the 
<a href=http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#infoitem.document>[all declarations processed]</a>
property
<cite class="bibref normative">[<a href=#ref-INFOSET>INFOSET</a>]</cite>
would be false.</td></tr>
</tbody>
</table>

<p>If no attribute type information is available, or if the source
of the information does not distinguish 
<a href=http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#intro.null>no
value</a> and
<a href=http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#intro.null>unknown</a>
<cite class="bibref normative">[<a href=#ref-INFOSET>INFOSET</a>]</cite>, 
then the value
<a href=#NO_TYPE_ATTR><code>NO_TYPE_ATTR</code></a> 
<em class=rfc2119>MUST</em> be used.</p>

<div class="note memo">
<p>An <a href=#AttributeDefinition><code>AttributeDefinition</code></a> node
created by the 
<a href=#createAttributeDefinition><code>createAttributeDefinition</code></a>
method has its <a href=#declaredType><code>declaredType</code></a> attribute
set to <a href=#NO_TYPE_ATTR><code>NO_TYPE_ATTR</code></a>.</p>
</div>

<p>If the source of the information does not distinguish
<a href=http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#intro.null>no
value</a> and/or
<a href=http://www.w3.org/TR/2004/REC-xml-infoset-20040204/#intro.null>unknown</a>
<cite class="bibref normative">[<a href=#ref-INFOSET>INFOSET</a>]</cite> and
<code>CDATA</code>
<cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
<a href=#ref-XML11>XML11</a>]</cite>, then the value
<a href=#CDATA_ATTR><code>CDATA_ATTR</code></a> <em class=rfc2119>MUST</em>
be used.</p>

<p>In Perl binding
<cite class="bibref normative">[<a href=#ref-DOMPERL>DOMPERL</a>]</cite>, the
<a href=#attr><code>Attr</code></a> nodes <em class=rfc2119>MUST</em> implement the
<a href=#DeclaredValueType><code>DeclaredValueType</code></a>
definition group.</p>

  </dd>
<dt><dfn class=dom-attr id=allowedTokens><code>allowedTokens</code></dfn> of
type <code>DOMString</code>[]</dt>
  <dd><p>The list of allowed attribute values.</p>

  <p>On getting, the attribute <em class=rfc2119>MUST</em> return the
  <code>DOMStringList</code> object associated to this attribute.  The object
  <em class=rfc2119>MAY</em> contain zero or more ordered strings, consist of
  zero or more characters respectively, possibly with duplications.

  </p><p>If the <a href=#AttributeDefinition><code>AttributeDefinition</code></a>
  node is created during the process to create a <abbr>DOM</abbr> from an 
  <abbr>XML</abbr> document, the object <em class=rfc2119>MUST</em> contain
  the names or name tokens allowed for the attribute defined by the node.
  If the document is well-formed, the object will be empty unless 
  the <a href=#declaredType><code>declaredType</code></a> is 
  <a href=#ENUMERATION_ATTR><code>ENUMERATION_ATTR</code></a> or
  <a href=#NOTATION_ATTR><code>NOTATION_ATTR</code></a>.</p>

  <p>If the <a href=#declaredType><code>declaredType</code></a> is different
  from <a href=#ENUMERATION_ATTR><code>ENUMERATION_ATTR</code></a> or
  <a href=#NOTATION_ATTR><code>NOTATION_ATTR</code></a>, this attribute
  <em class=rfc2119>MUST</em> be ignored for the purpose of serializing
  into (part of) <abbr>XML</abbr> document.</p>

  <div class="note memo">
    <p>When serializing the node it should be noted that the object might
    be empty, might contain duplications, and might contain strings that are
    not names or name tokens.</p>
  </div></dd>
<dt><dfn class=dom-attr id=defaultType><code>defaultType</code></dfn> of
type <code>unsigned short</code></dt>
  <dd><p>The type of the default for the attribute.  It is expected that this 
  attribute contains a value from the definition group
  <a href=#DefaultValueType><code>DefaultValueType</code></a>.</p>

  <p>On getting, the attribute <em class=rfc2119>MUST</em> return
  the value associated to this attribute.</p>

  <p>On setting, it <em class=rfc2119>MUST</em> set the specified
  value as the value associated to this attribute.</p>

  <p>If the 
  <a href=#AttributeDefinition><code>AttributeDefinition</code></a> node is
  created during the process to create a <abbr>DOM</abbr> from an
  <abbr>XML</abbr> document, an appropriate value from the
  <a href=#DefaultValueType><code>DefaultValueType</code></a> definition
  group <em class=rfc2119>MUST</em> be set to the attribute.</p>

  <!-- DefaultValueType -->
  <p>The definition group
  <dfn id=DefaultValueType><code>DefaultValueType</code></dfn>
  contains integers indicating the type of the default for the attribute.
  The definition group contains the following constants:</p>

  <table>
  <thead>
  <tr><th scope=col>Name</th><th scope=col>Value</th><th scope=col>Description</th></tr>
  </thead>
  <tbody>
  <tr>
  <th scope=row><dfn class=dom-const id=UNKNOWN_DEFAULT><code>UNKNOWN_DEFAULT</code></dfn>
  </th><td><code>0</code></td><td>Unknown.</td></tr>
  <tr>
  <th scope=row><dfn class=dom-const id=FIXED_DEFAULT><code>FIXED_DEFAULT</code></dfn>
  </th><td><code>1</code></td><td>Provided explicitly and only the value is allowed.
  <cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
  <a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
  <tr>
  <th scope=row><dfn class=dom-const id=REQUIRED_DEFAULT><code>REQUIRED_DEFAULT</code></dfn>
  </th><td><code>2</code></td><td>No default value and the attribute have to be
  explicitly specified.</td></tr>
  <tr>
  <th scope=row><dfn class=dom-const id=IMPLIED_DEFAULT><code>IMPLIED_DEFAULT</code></dfn>
  </th><td><code>3</code></td><td>Implied
  <cite class="bibref normative">[<a href=#ref-XML10>XML10</a>,
  <a href=#ref-XML11>XML11</a>]</cite>.</td></tr>
  <tr>
  <th scope=row><dfn class=dom-const id=EXPLICIT_DEFAULT><code>EXPLICIT_DEFAULT</code></dfn>
  </th><td><code>4</code></td><td>Provided explicitly.</td></tr>
  </tbody>
  </table>

  <p>If the source of the default type does not distinguish
  implied and unknown default types, then the value
  <a href=#IMPLIED_DEFAULT><code>IMPLIED_DEFAULT</code></a>
  <em class=rfc2119>MUST</em> be used.</p>

  <div class="note memo">
  <p>An <a href=#AttributeDefinition><code>AttributeDefinition</code></a>
  node created by the
  <a href=#createAttributeDefinition><code>createAttributeDefinition</code></a>
  method has its <a href=#defaultType><code>defaultType</code></a>
  attribute set to
  <a href=#UNKNOWN_DEFAULT><code>UNKNOWN_DEFAULT</code></a>.</p>
  </div></dd>
</dl>

</div>

<div class=section id=section-entity>
<h2 id=general-entities><span class=secno>8 </span>General entities</h2>

<p>The <a href=#entity><code>Entity</code></a> node is known as <dfn id=concept-general-entity title=concept-general-entity>general entity</dfn>, or when not
ambiguous, simply <dfn id=concept-entity title=concept-entity>entity</dfn>.

</p><p>Each <a href=#concept-entity title=concept-entity>entity</a> has an associated
<dfn id=concept-entity-publicid title=concept-entity-publicid>public ID</dfn> and <dfn id=concept-entity-systemid title=concept-entity-systemid>system ID</dfn>.  Unless otherwise
specified, their values are the empty string when the <a href=#concept-entity title=concept-entity>entity</a> is created.

</p><pre class=idl><code>partial interface <a href=#entity>Entity</a> {
  readonly attribute <a href=#documenttype>DocumentType</a>? <a href=#dom-ownerdocumenttypedefinition title=dom-ownerDocumentTypeDefinition>ownerDocumentTypeDefinition</a>;

  [TreatNullAs=EmptyString] attribute DOMString <a href=#dom-publicid title=dom-publicId>publicId</a>;
  [TreatNullAs=EmptyString] attribute DOMString <a href=#dom-systemid title=dom-systemId>systemId</a>;
  attribute <span>DOMString</span>? <a href=#dom-declarationbaseuri title=dom-declarationBaseURI>declarationBaseURI</a>;
  attribute <span>DOMString</span>? <a href=#dom-manakaideclarationbaseuri title=dom-manakaiDeclarationBaseURI>manakaiDeclarationBaseURI</a>;
  attribute <span>DOMString</span>? <span title=dom-Entity-notationName>notationName</span>;
  readonly attribute <span>DOMString</span> <a href=#dom-entity-hasreplacementtree title=dom-Entity-hasReplacementTree>hasReplacementTree</a>;
  attribute <span>DOMString</span>? <a href=#dom-entity-manakaientityuri title=dom-Entity-manakaiEntityURI>manakaiEntityURI</a>;
  attribute <span>DOMString</span>? <a href=#dom-manakaientitybaseuri title=dom-manakaiEntityBaseURI>manakaiEntityBaseURI</a>;
  attribute boolean <a href=#isExternallyDeclared>isExternallyDeclared</a>;
};</code></pre>

<p>Each <a href=#concept-entity title=concept-entity>entity</a> has an associated
<dfn id=concept-entity-notation-name title=concept-entity-notation-name>notation name</dfn>.  Unless
otherwise specified, it is <a href=#null>null</a> when the <a href=#concept-entity title=concept-entity>entity</a> is created.

</p><p>The <code title=dom-Entity-notationName>notationName</code>
attribute returns the <a href=#concept-entity-notation-name title=concept-entity-notation-name>notation name</a> of the
<a href=#context-object>context object</a>.<!-- Normatively defined in DOM3CORE -->

</p><p>On setting, the <code title=dom-Entity-notationName>notationName</code> attribute of the
<a href=#entity><code>Entity</code></a> interface <em class=rfc2119>MUST</em> set the
<a href=#concept-entity-notation-name title=concept-entity-notation-name>notation name</a> of the
<a href=#context-object>context object</a> to the new value.

</p><div class="note memo">
<p>In DOM3 Core specification, this attribute was read-only.
</p></div>

<div class="note memo">
<p>Setting an invalid name to this attribute would make the node
unserializable in the XML syntax.
</p></div>

<p>Each <a href=#concept-entity title=concept-entity>entity</a> has an associated
<dfn id=concept-entity-replacement-text title=concept-entity-replacement-text>replacement text</dfn>.
Unless otherwise specified, the <a href=#concept-entity-replacement-text title=concept-entity-replacement-text>replacement text</a> is the
empty string when an <a href=#concept-entity title=concept-entity>entity</a> is
created.

</p><dl>
<dt><dfn class=dom-attr id=isExternallyDeclared><code>isExternallyDeclared</code></dfn>
of type <code>boolean</code></dt>
  <dd><p>Whether the entity is declared by an external entity declaration or 
  not.  If the value is <code>true</code>, the entity is declared in an entity
  declaration in the external subset entity or in an external parameter entity.
  If the value is <code>false</code>, the entity is declared in an entity
  declaration in the internal subset, or the node is created in memory.</p>

  <p>On getting, the attribute <em class=rfc2119>MUST</em> return
  the value associated to this attribute.</p>

  <p>On setting, it <em class=rfc2119>MUST</em> set the specified
  value as the value associated to this attribute.</p>

  <p>If the <a href=#Entity><code>Entity</code></a> node is created during
  the process to create a <abbr>DOM</abbr> from an <abbr>XML</abbr> document,
  the following requirements are applied:  If the entity is an unparsed
  entity, then the attribute <em class=rfc2119>MUST</em> be set to 
  <code>false</code>.  Otherwise, i.e. the entity is a parsed entity, then the
  attribute <em class=rfc2119>MUST</em> be set to the value of whether the
  entity is declared by an external markup declaration or not.</p></dd>
</dl>

<hr>

<p>A <a href=#concept-entity title=concept-entity>entity</a> has associated <dfn id=concept-entity-url title=concept-entity-url>entity URL</dfn> and <dfn id=concept-entity-base-url title=concept-entity-base-url>entity base URL</dfn>.  Unless otherwise
specified, their values are <a href=#null>null</a>.

</p><p>On getting, the <dfn id=dom-entity-manakaientityuri title=dom-Entity-manakaiEntityURI><code>manakaiEntityURI</code></dfn>
attribute of the <a href=#entity><code>Entity</code></a> interface <em class=rfc2119>MUST</em> run these steps:

</p><ol>

<li>If the <a href=#concept-entity-url title=concept-entity-url>entity URL</a> of the
<a href=#context-object>context object</a> is not <a href=#null>null</a>, return it and
abort these steps.

</li><li>Otherwise, if the <a href=#concept-entity-systemid title=concept-entity-systemid>system
ID</a> of the <a href=#context-object>context object</a> is not the empty string,
<a href=#resolve-a-url title="resolve a URL">resolve</a> it relative to the <a href=#concept-effective-declaration-base-url title=concept-effective-declaration-base-url>effective declaration
base URL</a> of the <a href=#context-object>context object</a>.  If it succeeded,
return the result and abort these steps.

</li><li>Return <a href=#null>null</a>.

</li></ol>

<p>On setting, the attribute <em class=rfc2119>MUST</em> run these
steps:

</p><ol>

<li>If the new value is <a href=#null>null</a>, set the <a href=#concept-entity-url title=concept-entity-url>entity URL</a> of the <a href=#context-object>context
object</a> to <a href=#null>null</a> and abort these steps.

</li><li><a href=#resolve-a-url title="resolve a URL">Resolve</a> the new value relative
to the <a href=#concept-effective-declaration-base-url title=concept-effective-declaration-base-url>effective
declaration base URL</a> of the <a href=#context-object>context object</a>.  Set
the <a href=#concept-entity-url title=concept-entity-url>entity URL</a> of the
<a href=#context-object>context object</a> to the result if succeeded, or
<a href=#null>null</a> otherwise.

</li></ol>

<div class="note memo">

<p>It is expected that an <span>XML Parser</span> supporting this
specification set the <a href=#concept-entity-url title=concept-entity-url>entity URL</a>
when an external entity is read.

</p></div>

</div><!-- section -->

<div class=section id=section-notation>
<h2 id=notations><span class=secno>9 </span>Notations</h2>

<p>The <a href=#notation><code>Notation</code></a> node is simply known as <dfn id=concept-notation title=concept-notation>notation.

</dfn></p><p>Each <a href=#concept-notation title=concept-notation>notation</a> has an associated
<dfn id=concept-notation-publicid title=concept-notation-publicid>public ID</dfn> and <dfn id=concept-notation-systemid title=concept-notation-systemid>system ID</dfn>.  Unless otherwise
specified, their values are the empty string when the <a href=#concept-notation title=concept-notation>notation</a> is created.

</p><pre class=idl><code>partial interface <a href=#notation>Notation</a> {
  readonly attribute <a href=#documenttype>DocumentType</a>? <a href=#dom-ownerdocumenttypedefinition title=dom-ownerDocumentTypeDefinition>ownerDocumentTypeDefinition</a>;
  [TreatNullAs=EmptyString] attribute DOMString <a href=#dom-publicid title=dom-publicId>publicId</a>;
  [TreatNullAs=EmptyString] attribute DOMString <a href=#dom-systemid title=dom-systemId>systemId</a>;
  attribute <span>DOMString</span>? <a href=#dom-declarationbaseuri title=dom-declarationBaseURI>declarationBaseURI</a>;
  attribute <span>DOMString</span>? <a href=#dom-manakaideclarationbaseuri title=dom-manakaiDeclarationBaseURI>manakaiDeclarationBaseURI</a>;
};</code></pre>

</div><!-- section -->

<div class=section>
<h2 id=base-urls><span class=secno>10 </span>Base URLs</h2>

<p>To determine the <a href=#concept-node-base-url title=concept-node-base-url>base URL</a>
of a <span title=concept-node>node</span> <var title="">node</var>, these
steps <em class=rfc2119>MUST</em> be followed:

</p><ol>

<li>If <var title="">node</var> is a <a href=#document-0><code>Document</code></a>, return
<a href=#document-base-url>document base URL</a> of <var title="">node</var> and abort
these steps.

</li><li>If <var title="">node</var> is the <code>base</code> attribute in the
<a href=#xml-namespace>XML namespace</a>:

  <dl class=switch>

  <dt>If the <a href=#concept-attribute-owner-element title=concept-attribute-owner-element>owner
  element</a> of <var title="">node</var> is <a href=#null>null</a> </dt><dt>If
  the <a href=#concept-tree-parent title=concept-tree-parent>parent</a> of the <a href=#concept-attribute-owner-element title=concept-attribute-owner-element>owner element</a> of <var title="">node</var> is <a href=#null>null</a>

  </dt><dd>Return the <a href=#concept-node-base-url title=concept-node-base-url>base URL</a> of
  the <a href=#concept-node-document title=concept-node-document>node document</a> of <var title="">node</var> and abort these steps.

  </dd><dt>Otherwise

  </dt><dd>Return the <a href=#concept-node-base-url title=concept-node-base-url>base URL</a> of
  the <a href=#concept-tree-parent title=concept-tree-parent>parent</a> of the <a href=#concept-attribute-owner-element title=concept-attribute-owner-element>owner element</a> of <var title="">node</var> and abort these steps.
  
  </dd></dl>

</li><li>Otherwise, if <var title="">node</var> is an <span title=concept-attribute>attribute</span>:

  <dl class=switch>

  <dt>If the <a href=#concept-attribute-owner-element title=concept-attribute-owner-element>owner
  element</a> of <var title="">node</var> is <a href=#null>null</a>

  </dt><dd>Return the <a href=#concept-node-base-url title=concept-node-base-url>base URL</a> of
  the <a href=#concept-node-document title=concept-node-document>node document</a> of <var title="">node</var> and abort these steps.

  </dd><dt>Otherwise

  </dt><dd>Return the <a href=#concept-node-base-url title=concept-node-base-url>base URL</a> of
  the <a href=#concept-attribute-owner-element title=concept-attribute-owner-element>owner element</a>
  of <var title="">node</var> and abort these steps.
  
  </dd></dl>

</li><li>If <var title="">node</var> is an <span title=concept-element>element</span> and it has the <code>base</code>
attribute in the <span title="">XML namespace</span>, <a href=#resolve-a-url title="resolve a URL">resolve</a> the <span title=concept-attribute-value>value</span> of the <span title=concept-attribute>attribute</span> relative to the <a href=#concept-node-base-url title=concept-node-base-url>base URL</a> of the <span title=concept-attribute>attribute</span>.  If it succeeded, return the
result and abort these steps.

</li><li>If the <a href=#concept-tree-parent title=concept-tree-parent>parent</a> of <var title="">node</var> is not <a href=#null>null</a>, return the <a href=#concept-node-base-url title=concept-node-base-url>base URL</a> of the <a href=#concept-tree-parent title=concept-tree-parent>parent</a> and abort these steps.

</li><li><!-- If <var title>node</var> is not <span>in a document</span>,
r-->Return the <a href=#concept-node-base-url title=concept-node-base-url>base URL</a> of
the <a href=#concept-node-document title=concept-node-document>node document</a> of <var title="">node</var> and abort these steps.

</li></ol>

<div class="note memo">

<p>These steps ignore external entity boundary, which is a
<a href=#willful-violation>willful violation</a> to the <cite>XML Base</cite>
specification <cite class="bibref informative">[<a href=#ref-XMLBASE>XMLBASE</a>]</cite>.

</p></div>

<hr>

<p>On getting, the <dfn id=dom-documenttype-declarationbaseuri title=dom-DocumentType-declarationBaseURI><code>declarationBaseURI</code></dfn>
and <dfn id=dom-documenttype-manakaideclarationbaseuri title=dom-DocumentType-manakaiDeclarationBaseURI><code>manakaiDeclarationBaseURI</code></dfn>
attributes of the <a href=#documenttype><code>DocumentType</code></a> interface <em class=rfc2119>MUST</em> return the <a href=#concept-node-base-url title=concept-node-base-url>base URL</a> of the <a href=#context-object>context
object</a>.  On setting, they <em class=rfc2119>MUST</em> do
nothing.

</p><p>Each <a href=#concept-entity title=concept-entity>entity</a> or <a href=#concept-notation title=concept-notation>notation</a> has an associated <dfn id=concept-declaration-base-url title=concept-declaration-base-url>declaration base URL</dfn>.  Its
default value is <a href=#null>null</a>.

</p><p>On getting, the <dfn id=dom-declarationbaseuri title=dom-declarationBaseURI><code>declarationBaseURI</code></dfn> and
<dfn id=dom-manakaideclarationbaseuri title=dom-manakaiDeclarationBaseURI><code>manakaiDeclarationBaseURI</code></dfn>
attributes of the <a href=#entity><code>Entity</code></a> or <a href=#notation><code>Notation</code></a>
interface <em class=rfc2119>MUST</em> return <dfn id=concept-effective-declaration-base-url title=concept-effective-declaration-base-url>effective declaration
base URL</dfn>, i.e. the <a href=#concept-declaration-base-url title=concept-declaration-base-url>declaration base URL</a> of the
<a href=#context-object>context object</a> if it is not <a href=#null>null</a>, or the
<a href=#concept-node-base-url title=concept-node-base-url>base URL</a> of the <a href=#context-object>context
object</a> otherwise.

</p><p>On setting, they <em class=rfc2119>MUST</em> run these steps:

</p><ol>

<li>If the new value is <a href=#null>null</a>, set the <a href=#concept-declaration-base-url title=concept-declaration-base-url>declaration base URL</a> of the
<a href=#context-object>context object</a> to <a href=#null>null</a> and abort these
steps.

</li><li>Otherwise, <a href=#resolve-a-url title="resolve a URL">resolve</a> the new
value relative to the <a href=#concept-node-base-url title=concept-node-base-url>base
URL</a> of the <a href=#context-object>context object</a>.  Set the <a href=#concept-declaration-base-url title=concept-declaration-base-url>declaration base URL</a> of the
<a href=#context-object>context object</a> to the result, if it succeeded, or
<a href=#null>null</a>, otherwise.

</li></ol>

<hr>

<pre class=idl><code>partial interface <a href=#document-0>Document</a> {
  attribute <span>DOMString</span>? <a href=#dom-manakaientitybaseuri title=dom-manakaiEntityBaseURI>manakaiEntityBaseURI</a>;
};</code></pre>

<p>The <span title=concept-document>document</span>, like <a href=#concept-entity title=concept-entity>entities</a>, has the <a href=#concept-entity-base-url title=concept-entity-base-url>entity base URL</a>, initially
<a href=#null>null</a>.

</p><p>On getting, the <dfn id=dom-manakaientitybaseuri title=dom-manakaiEntityBaseURI><code>manakaiEntityBaseURI</code></dfn>
attribute of the <a href=#document-0><code>Document</code></a> or <a href=#entity><code>Entity</code></a>
interface <em class=rfc2119>MUST</em> run these steps:

</p><ol>

<li>If the <a href=#concept-entity-base-url title=concept-entity-base-url>entity base URL</a>
of the <a href=#context-object>context object</a> is not <a href=#null>null</a>, return it
and abort these steps.

</li><li>Otherwise, if the <a href=#context-object>context object</a> is
<a href=#entity><code>Entity</code></a>, return the <a href=#dom-entity-manakaientityuri><code title=dom-Entity-manakaiEntityURI>manakaiEntityURI</code></a> attribute
value of the <a href=#context-object>context object</a> if it is not
<a href=#null>null</a>.

</li><li>Otherwise, return the <a href=#concept-node-base-url title=concept-node-base-url>base
URL</a> of the <a href=#context-object>context object</a>.

</li></ol>

<p>On setting, the attribute <em class=rfc2119>MUST</em> run these
steps:

</p><ol>

<li>If the new value is <a href=#null>null</a>, set the <a href=#concept-entity-base-url title=concept-entity-base-url>entity base URL</a> of the
<a href=#context-object>context object</a> to <a href=#null>null</a> and abort these
steps.

</li><li><a href=#resolve-a-url title="resolve a URL">Resolve</a> the new value relative
to the <a href=#dom-entity-manakaientityuri><code title=dom-Entity-manakaiEntityURI>manakaiEntityURI</code></a>
attribute value, if the <a href=#context-object>context object</a> is an
<a href=#entity><code>Entity</code></a> and it it not <a href=#null>null</a>, or the <a href=#concept-node-base-url title=concept-node-base-url>base URL</a> otherwise, of the
<a href=#context-object>context object</a>.  Set the <a href=#concept-entity-base-url title=concept-entity-base-url>entity base URL</a> of the
<a href=#context-object>context object</a> to the result if succeeded, or
<a href=#null>null</a> otherwise.

</li></ol>

<div class="note memo">

<p>It is expected that an <span>XML Parser</span> supporting this
specification set the <a href=#concept-entity-base-url title=concept-entity-base-url>entity base
URL</a> when a document or external entity is read.  If the entity
is retrieved using HTTP, the <code>Content-Base:</code> and
<code>Content-Location:</code> header fields might affect the value.
Note also that they does not affect the value of the <a href=#document-base-url>document
base URL</a> of the <span title=concept-document>document</span>.

</p></div>


</div><!-- section -->

<div class=section>
<h2 id=obsolete-features><span class=secno>11 </span>Obsolete features</h2>

<div class=section id=features>
<h3 id=the-dom-feature-string-for-the-dom-document-type-definitions><span class=secno>11.1 </span>The DOM feature string for the DOM Document Type Definitions</h3>

<p>Ealier versions of this specification defined the DOM feature <cite class="bibref normative">[<a href=#ref-DOM3CORE>DOM3CORE</a>]</cite>
<dfn id=feature-XDoctype><code>http://suika.suikawiki.org/www/2006/feature/XDoctype</code></dfn>
version <dfn id=feature-XDoctype-3.0><code>3.0</code></dfn>.
</p></div><!-- section -->

<div class=section>
<h3 id=obsolete-attribute><span class=secno>11.2 </span>Obsolete attribute</h3>

<p>The <code id=internalSubset>internalSubset</code> attribute of the
<a href=#DocumentTypeDefinition><code>DocumentTypeDefinition</code></a>
interface has been removed.

</p><p>The <dfn id=dom-entity-hasreplacementtree title=dom-Entity-hasReplacementTree><code id=hasReplacementTree>hasReplacementTree</code></dfn> attribute of the
<a href=#entity><code>Entity</code></a> interface <em class=rfc2119>MUST</em> return
<span>false</span>.

</p><div class="note memo">

<p>The attribute was used to get or set whether the <a href=#concept-entity title=concept-entity>entity</a> has the replacement subtree (as its
<code title=dom-Node-childNodes>childNodes</code>) or not.

</p></div>

<pre class=idl><code>partial interface <span>Element</span> {
  readonly attribute DOMString? <a href=#dom-manakaibaseuri title=dom-manakaiBaseURI>manakaiBaseURI</a>;
};

partial interface <span>ProcessingInstruction</span> {
  readonly attribute DOMString? <a href=#dom-manakaibaseuri title=dom-manakaiBaseURI>manakaiBaseURI</a>;
};</code></pre>

<p>The <dfn id=dom-manakaibaseuri title=dom-manakaiBaseURI><code>manakaiBaseURI</code></dfn>
attribute of the <code>Element</code> and
<code>ProcessingInstruction</code> interfaces <em class=rfc2119>MUST</em> return <a href=#null>null</a>.

</p></div><!-- section -->

</div><!-- section -->

<div class="section reference" id=references>
<h2 class=no-num id=references-0>References</h2>

<div class=ed>
<p>Need to update references
</p></div>

<div class="section normative reference" id=normative-references>
<h3 class=no-num id=normative-references-0>Normative References</h3>

<dl>

<dt id=ref-DOM>DOM
</dt><dd><cite><a href=http://dom.spec.whatwg.org/>DOM
Standard</a></cite>, WHATWG.

</dd><dt id=ref-DOM3CORE>DOM3CORE</dt>
  <dd><cite><a href=http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407>Document
  Object Model (<abbr>DOM</abbr>) Level 3 Core Specification, Version 
  1.0</a></cite>, <abbr>W3C</abbr> Recommendation, <time datetime=2004-04-07>7
  April 2004</time>.  <em>This</em> version of the specification is referenced.
  The latest version of the specification is available at
  <code class=uri>&lt;<a href=http://www.w3.org/TR/DOM-Level-3-Core>http://www.w3.org/TR/DOM-Level-3-Core</a>&gt;</code>.</dd>
<dt id=ref-DOMBIND>DOMBIND</dt>
  <dd><cite><a href=http://www.w3.org/TR/2007/WD-DOM-Bindings-20071017/>Language
  Bindings for <abbr>DOM</abbr> Specifications</a></cite>, <abbr>W3C</abbr>
  Working Draft, <time datetime=2007-10-17>17 October 2007</time>.  
  <em>This</em> version of the specification is referenced.  The latest version
  of the specification is available at
  <code class=uri>&lt;<a href=http://www.w3.org/TR/DOM-Bindings/>http://www.w3.org/TR/DOM-Bindings/</a>&gt;</code>.</dd>
<dt id=ref-DOMPERL>DOMPERL</dt>
  <dd><cite><a href=http://suika.suikawiki.org/gate/2005/sw/manakai/DOM%20Perl%20Binding>manakai's
  <abbr>DOM</abbr> Perl Binding</a></cite>, editor's draft.  Work in 
  progress.</dd>
<dt id=ref-HTML5>HTML5</dt>
  <dd><cite><a href=http://whatwg.org/html5><abbr>HTML</abbr> 5</a></cite>,
  <abbr title="Web Hypertext Application Technology Working Group">WHATWG</abbr>
  Working Draft.  Work in progress.</dd>
<dt id=ref-INFOSET>INFOSET</dt>
  <dd><cite><a href=http://www.w3.org/TR/2004/REC-xml-infoset-20040204><abbr>XML</abbr>
  Information Set (Second Edition)</a></cite>, <abbr>W3C</abbr> Recommendation,
  <time datetime=2004-02-04>4 February 2004</time>.  <em>This</em> version of
  the specification is referenced.  The latest version of the specification is
  available at
  <code class=uri>&lt;<a href=http://www.w3.org/TR/xml-infoset>http://www.w3.org/TR/xml-infoset</a>&gt;</code>.</dd>
<dt id=ref-KEYWORDS>KEYWORDS</dt>
  <dd><cite><a href=urn:ietf:rfc:2119>Key words for use in 
  <abbr>RFCs</abbr> to Indicate Requirement Levels</a></cite>,
  <abbr title="Internet Engineering Task Force">IETF</abbr> 
  <a href=urn:ietf:bcp:14><abbr title="Best Current Practice">BCP</abbr> 
  14</a>, <abbr title="Request for Comments">RFC</abbr> 2119, 
  <time datetime=1997-03>March 1997</time>.
  <em>This</em> version of the specification is referenced.</dd>
<dt id=ref-MANAKAI>MANAKAI</dt>
  <dd><cite><a href=http://suika.suikawiki.org/gate/2005/sw/manakai/DOM%20Extensions>
  manakai's <abbr>DOM</abbr> Extensions</a></cite>, editor's draft.  Work in 
  progress.</dd>
<dt id=ref-XML10>XML10</dt>
  <dd><cite><a href=http://www.w3.org/TR/2006/REC-xml-20060816>Extensible
  Markup Language (<abbr>XML</abbr>) 1.0 (Fourth Edition)</a></cite>,
  <abbr>W3C</abbr> Recommendation, <time datetime=2006-08-16>16 August 
  2006</time>, edited in place <time datetime=2006-09-29>29 September
  2006</time>.  <em>This</em> version of the specification is referenced.  The
  latest version of the specification is available at
  <code class=uri>&lt;<a href=http://www.w3.org/TR/xml>http://www.w3.org/TR/xml</a>&gt;</code>.</dd>
<dt id=ref-XML11>XML11</dt>
  <dd><cite><a href=http://www.w3.org/TR/2006/REC-xml11-20060816/>Extensible
  Markup Language (<abbr>XML</abbr>) 1.1 (Second Edition)</a></cite>,
  <abbr>W3C</abbr> Recommendation, <time datetime=2006-08-16>16 August 
  2006</time>, edited in place <time datetime=2006-09-29>29 September
  2006</time>.  <em>This</em> version of the specification is referenced.  The
  latest version of the specification is available at
  <code class=uri>&lt;<a href=http://www.w3.org/TR/xml11>http://www.w3.org/TR/xml11</a>&gt;</code>.</dd>
</dl>
</div>

<div class="section informative reference" id=informative-references>
<h3 class=no-num id=non-normative-references>Non-normative References</h3>

<dl>
<dt id=ref-DOM1WD>DOM1WD</dt>
  <dd><cite><a href=http://www.w3.org/TR/WD-DOM-971209/>Document Object
  Model Specification</a></cite>, <abbr>W3C</abbr> Working Draft,
  <time datetime=1997-12-09>9 December 1997</time>.</dd>
  <dd><cite><a href=http://www.w3.org/TR/WD-DOM-19980318/>Document Object
  Model Specification</a></cite>, <abbr>W3C</abbr> Working Draft,
  <time datetime=1998-03-18>18 March 1998</time>.</dd>
  <dd><cite><a href=http://www.w3.org/TR/1998/WD-DOM-19980416/>Document 
  Object Model Specification, Version 1.0</a></cite>, <abbr>W3C</abbr> Working
  Draft, <time datetime=1998-04-16>16 April 1998</time>.</dd>
<dt id=ref-DOM3AS>DOM3AS</dt>
  <dd><cite><a href=http://www.w3.org/TR/2002/NOTE-DOM-Level-3-AS-20020725/>Document
  Object Model (<abbr>DOM</abbr>) Level 3 Abstract Schemas Specification,
  Version 1.0</a></cite>, <abbr>W3C</abbr> Note, <time datetime=2002-07-25>25
  July 2002</time>.  The latest version of the specification is available at
  <code class=uri>&lt;<a href=http://www.w3.org/TR/DOM-Level-3-AS>http://www.w3.org/TR/DOM-Level-3-AS</a>&gt;</code>.</dd>

<dt id=ref-XMLBASE>XMLBASE

</dt><dd><cite><a href=http://www.w3.org/TR/xmlbase/>XML Base</a></cite>,
W3C.

</dd><dt id=ref-XSAPI>XSAPI</dt>
  <dd><cite><a href=http://www.w3.org/Submission/2004/SUBM-xmlschema-api-20040309/><abbr>XML</abbr>
  Schema <abbr>API</abbr></a></cite>, <abbr>W3C</abbr> Member Submission,
  <time datetime=2004-03-09>9 March 2004</time>.  The latest version of the
  specification is available at
  <code class=uri>&lt;<a href=http://www.w3.org/Submission/xmlschema-api/>http://www.w3.org/Submission/xmlschema-api/</a>&gt;</code>.</dd>
</dl>
</div>

</div>



</body></html>