<!DOCTYPE html>
<html lang="en" class="formal-specification anolis">
<head>
<title>DOM Tree Validation</title>
<meta charset=utf-8>
<link rel=stylesheet href=spec.css>
<link rel="license" href="#license">
</head>
<body class="has-abstract">

<header>

<hgroup>
  <h1 class="no-toc no-num">DOM Tree Validation</h1>
  <h2 class="no-toc no-num">The manakai project, [DATE]</h2>
</hgroup>

<dl class="versions-uri">

<div>
<dt>Latest version
<dd><a href=https://manakai.github.io/spec-dom/validation-langs>https://manakai.github.io/spec-dom/validation-langs</a>
</div>

<div id=version-history>
<dt>Version history
<dd><a href=https://github.com/manakai/spec-dom/commits/gh-pages/validation-langs-source.en.html>https://github.com/manakai/spec-dom/commits/gh-pages/validation-langs-source.en.html</a>
</div>

</dl>

</header>

<section id=status>
<h1 class="no-toc no-num">Status of This Document</h1>

<p>This document is
a <a href="https://manakai.github.io/docs#specs">technical
specification</a> produced as part
of <a href="https://manakai.github.io/">the manakai project</a>.  It
might be updated, replaced, or obsoleted by other documents at any
time.

<p>The scope of this specification is limited to the products
within <a href="https://manakai.github.io/">the manakai project</a>.
It does not intended to be implemented by multiple parties, although
nothing prevents it from implemented by other DOM implementations.

<p>Comments on this document are welcome and may be sent to
the <a href="#author">author</a>.</p>

</section>

<section>
<h1 class="no-toc no-num">Table of contents</h1>
<!-- toc -->
</section>

<section>
<h1>Introduction</h1>

<p class=section-info><em>This section is non-normative.</em>

<p>This specification defines details of DOM tree validation not
covered by other <span title="applicable specification">applicable
specifications</span>.

<section>
<h1>Scope</h1>

<p>This specification defines:

<ul>

<li>how to choose the set of requirements used
for <span title=validate>validation</span> of a <span>node</span> when
there are multiple candidate specifications,

<li>how the requirements of feed format (RSS and Atom) specifications
are integrated with the platform,

<li>how OGP are <span title=validate>validated</span>,

and
<li>how <span title=element>elements</span>
and <span title=attribute>attributes</span> <span>in no
namespace</span> and in <span title="unknown namespace">unknown
namespaces</span> are <span title=validate>validated</span>,

</ul>

... for <span>validator</span> implementations
by <a href="https://manakai.github.io/">the manakai project</a>.

<p class=XXX>This specification will define:
XSLT validation;
template content validation;
handling of private vocabularies in validator;
and other integration issues.

The obsvocab specification might be merged with this specification in
due course.

</section>

<section id=history>
  <h1>History</h1>

  <p>This specification was originally published
  at <code class="URI">&lt;<a href="http://suika.suikawiki.org/www/markup/xml/validation-langs">http://suika.suikawiki.org/www/markup/xml/validation-langs</a>&gt;</code>
  as <cite>Handling of unknown namespaces in conformance
  checking</cite> since <time datetime=2013-12>December,
  2013</time>.  <!-- and its history was at
  <http://suika.suikawiki.org/gate/git/wi/markup/xmlexts.git/history/HEAD:/validation-langs-source.en.html>
  -->

  <p>Earlier versions of this specification contained non-normative
  descriptions of how to <span>validate</span>
  HTML <code id=checking-an-html-script-element>script</code>
  and <code id=checking-an-html-style-element>style</code> <span title=element>elements</span>.
  As definitions of these <span title=element>elements</span> were
  slightly simplified in the
  <a href=https://html.spec.whatwg.org><cite>HTML Standard</cite></a>,
  these descriptions were removed.

  <p>Earlier versions of this specification had
  defined <span>RDF/XML</span> integration, which is dropped due to
  lack of interest.

</section>

</section>

<section>
<h1>Infrastructure</h1>

<p>This specification depends on the
<a href=https://infra.spec.whatwg.org/><cite>Infra
Standard</cite></a>.  The terms

<dfn>list</dfn>,
<dfn>code point</dfn>,
<dfn>concatenate</dfn>,
<dfn>ASCII case-insensitive</dfn>,
<dfn>HTML namespace</dfn>,
<dfn>XML namespace</dfn>,
and
<dfn>XMLNS namespace</dfn>

are defined by the <a href=https://infra.spec.whatwg.org/><cite>Infra
Standard</cite></a>.

<p>For the purpose of this specification, <dfn title="user agent">user
agents</dfn> are <span title="conformance checker">conformance
checkers</span>, also known
as <span title=validator>validators</span>.

<p><span title="user agent">User agents</span>
<em class=rfc2119>MUST</em> implement
the <a href="https://dom.spec.whatwg.org/"><cite>DOM
Standard</cite></a>.  Terms

<dfn>child</dfn>, 
<dfn>parent</dfn>,
<dfn>ancestor</dfn>,
<dfn>node</dfn>,
<dfn>node document</dfn>,
<dfn>document</dfn>,
<dfn title=concept-document-content-type>content
type</dfn>, <dfn>HTML document</dfn>, <dfn>XHTML
document</dfn>, <dfn>document
element</dfn>, 
<dfn>element</dfn>,
<dfn>attribute list</dfn>,
<dfn>attribute</dfn>,
<dfn title="attribute value">value</dfn>,
<dfn>namespace</dfn> (of <span>element</span> or <span>attribute</span>),
<dfn>prefix</dfn> (of <span>element</span> or <span>attribute</span>),
<dfn>local name</dfn> (of <span>element</span> or <span>attribute</span>),
<dfn>comment</dfn> (<dfn title=dom-Comment><code>Comment</code></dfn>),
<dfn>processing instruction</dfn> (<dfn><code>ProcessingInstruction</code></dfn>),
<dfn>template content</dfn>,
<dfn>child text content</dfn>,
and
<dfn>shadow tree</dfn>

are defined by the <a href="https://dom.spec.whatwg.org/"><cite>DOM
Standard</cite></a>.

<p><span title="user agent">User
agents</span> <em class=rfc2119>MUST</em> implement the
<a href=https://html.spec.whatwg.org><cite>HTML Standard</cite></a>.
Terms

<dfn>applicable specification</dfn>,
<dfn>document base URL</dfn>,
<dfn>inter-element whitespace</dfn>,
<dfn>valid global date and time string</dfn>,
<dfn>valid e-mail address</dfn>,
and
<dfn>parse error</dfn>

are defined by the <a href=https://html.spec.whatwg.org><cite>HTML
Standard</cite></a>.


<p>User agents are not required to implement other specifications, but
are expected to follow steps defined in this specification.  For
example, a user agent might not <span title="supported
namespace">support</span> XSLT, but is is still required to detect
whether an element is interpreted per XSLT specifications or not as
defined by this specification.

<hr>

<p>The terms <dfn>valid URL</dfn> and <dfn>valid absolute URL</dfn>
are defined by <a href="http://url.spec.whatwg.org/">URL Standard</a>
as <i>URL</i> and <i>absolute URL</i>, respectively.

<p>The term <dfn>valid MIME type</dfn> is defined by <a
href="http://mimesniff.spec.whatwg.org/">MIME Sniffing Standard</a> as
<i>parsable MIME type</i>.

The <dfn><code>utf-8</code></dfn> character encoding is defined by <a
href="http://encoding.spec.whatwg.org/">Encoding Standard</a>.

<p>The term <dfn>valid language tag</dfn> is defined by <a
href="http://tools.ietf.org/html/bcp47">BCP 47</a>.

<p>The term

<a href=https://www.w3.org/TR/1999/REC-xslt-19991116#literal-result-element><dfn>literal result element</dfn></a>

is defined by the
<a href=https://www.w3.org/TR/1999/REC-xslt-19991116>XSLT1
specification</a>.

The <dfn>XSLT namespace</dfn> is
<code>http://www.w3.org/1999/XSL/Transform</code>.



<hr>

<p>When a value is required to match the production labeled
<code title>document</code> in the XML
specification<!-- <iframe srcdoc=""> in XML [HTML] -->,
it <em class=rfc2119>MUST</em> also conform to other requirements for
XML documents.

</section>

<section>
<h1>Validation modes</h1>

<p class=XXX>This seciton is at-risk.

<p>A <dfn>validation mode</dfn> identify the specifications that
describe the requirements used to <span>validate</span>
a <span>node</span>.  There are two <span title="validation
mode">modes</span>:

<dl class=switch>

<dt><dfn>Default mode</dfn>
<dd>Conformance of the <span>node</span> is governed by its definition
in the <span>native element specifications</span> or the <span>RSS2
specifications</span>, or by the rules for the <span title="unknown
namespace element">unknown namespace elements</span>
and <span title="unknown namespace attribute">attributes</span>.

The <dfn>native element specifications</dfn> are
the <span title="applicable specification">applicable
specifications</span> such as
<a href=https://html.spec.whatwg.org><cite>HTML Standard</cite></a>,
except for the <span>XSLT specifications</span>, the <span>RSS2
specifications</span>, and <em>this</em> specification.

<dt><dfn>XSLT mode</dfn>
<dd>Conformance of the <span>node</span> is governed by the <span>XSLT
specifications</span>.  For the purpose of this specification,
the <dfn>XSLT specifications</dfn> are any <span title="applicable
specification">applicable specifications</span> defining XSLT and its
extensions.

<dfn title="XSLT family element">XSLT family elements</dfn>
are <span>elements</span> in the <span>XSLT namespace</span> and
XSLT <span title="extension namespace">extension namespaces</span>
defined by <span>XSLT specifications</span>.  Note that
XSLT <span title="literal result element">literal result
elements</span> are not <span title="XSLT family element">XSLT family
elements</span>.

</dl>

<p>To <dfn>determine the validation mode</dfn> of
a <span>node</span> <var>node</var>, run these steps:

<ol class=steps>

<li>If <var>node</var> is a <span>document element</span>, switch
by <var>node</var>'s <span>node
document</span>'s <span title=concept-document-content-type>content
type</span>:

  <dl class=switch>

  <dt><code>application/xml</code> or <code>text/xml</code>

  <dd>If <var>node</var> is a <span>literal result element</span>
  and <var>node</var> has
  the <code>version</code> <span>attribute</span> in the <span>XSLT
  namespace</span>, return <span>XSLT mode</span> and abort these
  steps.

  <dt><code>application/xslt+xml</code> or <code>text/xsl</code>

  <dd>If <var>node</var> is an <span>XSLT family element</span> or
  a <span>literal result element</span>, return <span>XSLT mode</span>
  and abort these steps.

  </dl>

<li>Let <var>parent</var> be <var>node</var>'s <span>parent</span>.

<li>Let <var>parent mode</var> be <span>default mode</span>.

<li>If <var>parent</var> is not <code>null</code>, set <var>parent
node</var> to the result of <span title="determine the validation
mode">determining the validation mode</span> of <var>parent</var>.

<li>If <var>node</var> is an <span>XSLT family element</span>, or if
<var>parent mode</var> is <span>XSLT mode</span> and <var>node</var> is an
<span>literal result element</span>, return <span>XSLT mode</span> and
abort these steps.

<li>Return <span>default mode</span>.

</ol>

<section>
<h3>Document element</h3>

<p class=section-info><em>This section is non-normative.</em>

<p>Whether an element can be used as the <span>document element</span>
or not is determined by following steps:

<ol class=steps>

<li><span>Determine the validation mode</span> of the element.

<li>If the element is in the <span>XSLT mode</span>, return whether
the element is allowed as the <span>document element</span> according
to <span>XSLT specifications</span>.

<li>Otherwise, if the element is  in a
<span>supported namespace</span>, is a <span>RSS
1.0 <code>rdf:RDF</code> element</span>, or is an <span>RSS2
element</span>, return whether the element is allowed as
the <span>document element</span> by an <span>applicable
specification</span>.

<li>Otherwise, the element is an <span>unknown namespace
element</span>.  Return true.

</ol>

</section>

<section>
<h3>Checking an element</h3>

<p class=section-info><em>This section is non-normative.</em>

<p>Conformance of an element is checked as follows:

<ol class=steps>

<li><span>Determine the validation mode</span> of the element.

<li>Let <var>mode</var> be the <span>validation mode</span> of the
element.

<li>If <var>mode</var> is <span>XSLT mode</span>, check the element
according to <span>XSLT specifications</span>.

<li>Otherwise, if the element is <em>not</em> an <span>unknown
namespace element</span>:

  <ol>

  <li>If the element is defined in an <span>applicable
  specification</span>, check the element according to the
  specification.

  <li>Otherwise, report an "unknown element" error.

  </ol>

<li>Otherwise, the element is an <span>unknown namespace
element</span>.  Report an "unknown element" warning.

</ol>

</section>

</section>


<section>
<h1>Validation of unknown namespaces</h1>

<p>An <span>element</span> or <span>attribute</span> is <dfn>in no
namespace</dfn> <!-- or <dfn>in null namespace</dfn> --> if
its <span>namespace</span> is <code>null</code>.

<p>A <span>namespace</span> which is not <code>null</code>
is <dfn title="supported namespace">supported</dfn> if it is defined
by a <span title="native element specifications">native element
specification</span>.  If a <span>user
agent</span> <span title="supported
namespace">supports</span> <span>RSS1</span> but does
not <span title="supported
namespace">support</span> <span>RDF/XML</span>, the <span>RDF
namespace</span> is not considered as <span title="supported
namespace">supported</span> for the purpose of that <span>user
agent</span>.

<p>A <span>namespace</span> which is not <code>null</code>
is <dfn title="unknown namespace">unknown</dfn> if it is
not <span title="supported namespace">supported</span>.

<p>An <span>element</span> is <dfn>unknown namespace element</dfn> if
its <span>namespace</span> is <span title="unknown
namespace">unknown</span>, it is an <span>unknown RDF element</span>,
or it is <span>in no namespace</span> and is not an <span>RSS2
element</span>.

<p>An <span>attribute</span> is <dfn>unknown namespace attribute</dfn>
if its <span>namespace</span> is <span title="unknown
namespace">unknown</span> or it is an <span>unknown RDF
attribute</span>.<!-- attribute in no namespace is not unknown
namespace attribute -->

<hr>

<p>An <span>unknown namespace element</span> or <span>unknown
namespace attribute</span> <em class=rfc2119>MUST NOT</em> be used
anywhere except where they are explicitly allowed.<!-- Somewhat
redundant with HTML Standard but still worth clarifying. -->

<p>An <span>unknown namespace element</span> <em
class=rfc2119>MAY</em> be used as the <span>document element</span> or
as an orphan node.  It <em class=rfc2119>MAY</em> also be used where
any kind of <span>element</span> is allowed.

<p>An <span>unknown namespace
element</span> <em class=rfc2119>MAY</em> have
any <span>attribute</span> in no namespace or any
<span>unknown namespace attribute</span>.

<div class="note memo">

<p>Additionally, any <span>attribute</span> in
a <span>supported namespace</span> might also be specified to an
<span>unknown namespace element</span> as long as it is allowed by an
<span>applicable specification</span>.

</div>

<p>An <span>unknown namespace
element</span> <em class=rfc2119>MAY</em> have any kind
of <span>child</span> (unless otherwise disallowed).

<p>An <span>unknown namespace attribute</span> <em
class=rfc2119>MAY</em> have any value.

<p>An attribute in no namespace of an <span>unknown namespace
element</span> <em class=rfc2119>MAY</em> have any value.

<p>A <span>validator</span> <em class=rfc2119>MAY</em> report a
warning any <span>unknown namespace element</span> or <span>unknown
namespace attribute</span>, as use of it could be an authoring error.


<div class=note>

<p><span title=validator>Validators</span> are expected to report
errors or warnings on unknown elements and attributes useful for
authors.

<p>This specification is not intended to override any other
specification's requirements.

<p>For a public Web document, non-standard element which is not
defined by any <span>applicable specification</span> ought to be
reported as an error.

<div class=example>

<p>In the following example, as the <code>bookmark</code> element in
the <code>http://mybookmark.example/</code> namespace is not defined
<!--as <span>flow content</span>--> by any <span>applicable
specification</span>, this fragment is non-conforming:

<pre class=XML><code>&lt;div xmlns="http://www.w3.org/1999/xhtml">
  &lt;bookmark xmlns="http://mybookmark.example/">Hello&lt;/bookmark>
&lt;/div></code></pre>

</div>

<p>For XML data that is not expected to be directly shown to user
(e.g. an XML data retrieved via <code>XMLHttpRequest</code>), use of
null- or non-standard namespaces ought not to be an error.

<div class=example>

<p>For example, following document fragment should not be considered
as non-conforming, nevertheless none of <code>data</code> and
<code>item</code> elements and the <code>name</code> attribute is
defined by any public standard:

<pre class=XML><code>&lt;data>
  &lt;item name="x1"/>
  &lt;item name="x2">&lt;p xmlns="http://www.w3.org/1999/xhtml">Hi!&lt;/p>&lt;/item>
&lt;/data></code></pre>

<p>If the <code>p</code> element contained an <code>item</code>
element in no namespace, it ought to be reported as an error, as no
standard defines the <code>item</code> element in no namespace as
<span>phrasing content</span>.

</div>

<div class=example>

<p>If there is an element in the
<code>http://www.w3.org/2000/svg<mark>/</mark></code> namespace, an
error or warning ought to be reported.  It is likely an authoring
error.

</div>

</div>

</section>

<section>
<h1>Validation of feed namespaces</h1>

<section>
<h1>RSS1 elements</h1>

<p class=section-info><em>This section is only applied
to <span title="user agent">user agents</span>
<span title="supported
namespace">supporting</span> <span>RSS1</span>.</em>

<p>The <dfn>RSS1 specification</dfn> is
<a href=http://web.resource.org/rss/1.0/spec><cite>RDF Site Summary
(RSS) 1.0</cite></a>.

<p>The <dfn>RDF namespace</dfn>
is <code>http://www.w3.org/1999/02/22-rdf-syntax-ns#</code>.

<p>The <dfn>RSS namespace</dfn>
is <code>http://purl.org/rss/1.0/</code>.

<p>The <dfn>Dublin Core namespace</dfn> is
<a href=http://web.resource.org/rss/1.0/modules/dc/><!-- which
references http://dublincore.org/documents/dces/
--><code>http://purl.org/dc/elements/1.1/</code></a>.

<p>The <dfn>RSS content namespace</dfn> is
<a href=http://web.resource.org/rss/1.0/modules/content/><code>http://purl.org/rss/1.0/modules/content/</code></a>.

<p>The <dfn>Hatena namespace</dfn> is
<a href=http://developer.hatena.ne.jp/ja/documents/other/misc/xmlns><code>http://www.hatena.ne.jp/info/xmlns#</code></a>.

<p>The <dfn>RSS1 family namespaces</dfn> are 
the <span>RSS namespace</span>,
the <span>Dublin Core namespace</span>,
the <span>RSS content namespace</span>,
and
the <span>Hatena namespace</span>.

<div class=note>

<p>These are <span title=namespace>namespaces</span> supported by the
<a href=https://wiki.suikawiki.org/n/Feed%20Parsing><cite>Feed
Parsing</cite></a> specification for interpreting <span>RSS1</span>
documents.

</div>

<hr>

<p>An <span>element</span> in one of the <span>RSS1 family
namespaces</span> <em class=rfc2119>MUST</em> conform to the
descriptions of it in the <span title="applicable
specification">relevant specifications</span> (and this
specification).  Especially, the <span>content</span> of
an <span>element</span> in the <span>RSS
namespace</span> <em class=rfc2119>MUST</em> conform to
the <i>Model</i> of the <span>element</span> in the <span>RSS1
specification</span>.

<p>An <span>element</span> in one of the <span>RSS1 family
namespaces</span> <em class=rfc2119>MAY</em> have
an <span>attribute</span> which is shown in <i>Syntax</i> or prose in
the <span title="applicable specification">relevant
specifications</span>, as well as
the <code>lang</code> <span>attribute</span> in the <span>XML
namespace</span> and <span title=attribute>attributes</span> in
the <span>XMLNS namespace</span>.
Other <span title=attribute>attributes</span> <em class=rfc2119>MUST
NOT</em> be specified.<!-- The RSS1 specification does not explicitly
define the requirements on the attributes not shown in that
specification.  The RDF/XML specification allows xml:lang and xml:base
and ignores others (including xml:space).  And xml:base has gone. -->

<p>An <span>element</span> or <span>attribute</span> in one of
the <span>RSS1 family namespaces</span> <em class=rfc2119>MUST
NOT</em> be used unless it is defined by an <span>applicable
specification</span>.<!-- This is not explicitly defined by relevant
specifications, though one might be able to insist on this based on
the generic rules in the HTML Standard. -->  Anything other than
the <code>encoded</code> <span>element</span> <em class=rfc2119>MUST
NOT</em> be used in the <span>RSS content namespace</span>.<!-- The
RSS1 content module specification formally specifies several elements
no one has been using and contains a "draft" of the content:encoded
element which is a de facto standard.  -->

<hr>

<p>An <span>element</span> is an <dfn>RSS 1.0 <code>rdf:RDF</code>
element</dfn> if:

  <ul>

  <li>Its <span>prefix</span> is <code>rdf</code>,

  <li>Its <span>namespace</span> is the <span>RDF namespace</span>,

  <li>Its <span>local name</span> is <code>RDF</code>, and

  <li>Either:

    <ul>

    <li>Its <span>parent</span> is a <span>document</span> whose
    <span>content type</span> is <code>application/rss+xml</code>, or

    <li>It has an <code>xmlns</code> <span>attribute</span> in
    the <span>XMLNS namespace</span> whose <span title="attribute
    value">value</span> is the <span>RSS namespace</span> and
    an <code>rdf</code> <span>attribute</span> in the <span>XMLNS
    namespace</span><!-- xmlns:rdf --> whose <span title="attribute
    value">value</span> is the <span>RDF namespace</span>.

    </ul>

  </ul>

<p>If an <code>RDF</code> <span>element</span> in the 
<span>RDF namespace</span> is an <span>RSS 1.0 <code>rdf:RDF</code>
element</span>, it <em class=rfc2119>MUST</em>
be <span title=validate>validated</span> against the requirements
for <span>RSS1</span>.  Otherwise, it <em class=rfc2119>MUST</em>
be <span title=validate>validated</span> against the requirements
for <span>RDF/XML</span>.

<p>If a <code>Seq</code> <span>element</span> in the <span>RDF
namespace</span> is a <span>child</span> of
an <code>items</code> <span>element</span> in the <span>RSS1
namespace</span>, it <em class=rfc2119>MUST</em>
be <span title=validate>validated</span> against the requirements
for <span>RSS1</span>.  Otherwise, it <em class=rfc2119>MUST</em>
be <span title=validate>validated</span> against the requirements
for <span>RDF/XML</span>.

<p>If an <code>li</code> <span>element</span> in the <span>RDF
namespace</span> is a <span>child</span> of
a <code>Seq</code> <span>element</span> in the <span>RDF
namespace</span> that is <span title=validate>validated</span> against
the requirements for <span>RSS1</span>, it <em class=rfc2119>MUST</em>
be <span title=validate>validated</span> against the requirements
for <span>RSS1</span>.  Otherwise, it <em class=rfc2119>MUST</em>
be <span title=validate>validated</span> against the requirements
for <span>RDF/XML</span>.

<p>If the <span>RDF namespace</span> is <span title="supported
namespace">supported</span>, there is no <span>unknown RDF
element</span>.  Otherwise, an <span>element</span> is an <dfn>unknown
RDF element</dfn> if it is in the <span>RDF namespace</span> and is
not to be <span title=validate>validated</span> against the
requirements for <span>RDF/XML</span> according to the requirements in
this specification.

<p>If the <span>RDF namespace</span> is <span title="supported
namespace">supported</span>, there is no <span>unknown RDF
attribute</span>.  Otherwise, an <span>attribute</span> is
an <dfn>unknown RDF attribute</dfn> if it is in the <span>RDF
namespace</span> and is <em>not</em> an <span>attribute</span>
of <span>element</span> in the <span>RSS namespace</span>
or <span>element</span> in the <span>RDF namespace</span> that is not
an <span>unknown RDF element</span>.

<div class=note>

<p>Though the <span>RSS1 specification</span> references
the <span>RDF/XML specification</span>, a <span>user agent</span> can
implement the <span title=validate>validation</span> by just
implementing the requirements in the <span>RSS1 specification</span>
and this specification, ignoring the <span>RDF/XML
specification</span>.

</div>

<hr>

<p><span title=comment>Comments</span>, <span title="inter-element
whitespace">inter-element whitespaces</span>, and
<span title="processing instruction">processing
instructions</span> <em class=rfc2119>MAY</em> be inserted anywhere in
an <span>element</span> in the <span>RSS1 family
namespaces</span>.<!-- This is not explicitly described in the RSS1
specification but is the de facto interpretation. -->

<p>Any <span>unknown namespace
element</span> <em class=rfc2119>MAY</em> be inserted as
a <span>child</span> of an <code>channel</code>
or <code>item</code> <span>element</span> in the <span>RSS
namespace</span>, as long as all of the following conditions are met:

  <ul>

  <li>It is <em>not</em> <span>in no
  namespace</span>.<!-- namespace-based extensions are allowed by RSS
  1.0 specification -->

  <li>Its <span>namespace</span> is <em>not</em> the <span>RDF
  namespace</span>.<!-- to conform to RDF/XML specification -->

  <li>If its <span>prefix</span> is <code>null</code>, its <span>local
  name</span> does not start with <code>xml</code> (<span>ASCII
  case-insensitive</span>).<!-- to avoid to be ignored by RDF/XML
  processing -->

  <li>Its <span>prefix</span> does not start with <code>xml</code>
  (<span>ASCII case-insensitive</span>).<!-- to avoid to be ignored by
  RDF/XML processing -->

  <li>There is no <span>sibling</span> <span>element</span> with
  same <span>namespace</span> and <span>local name</span> pair.<!-- to
  conform RSS 1.0 extensibility rule -->

  </ul>

<hr>

<p>A <code>description</code> <span>element</span> in the <span>RSS namespace</span> whose
<span>parent</span> is an <code>item</code> <span>element</span> in
the <span>RSS namespace</span> has an <span>HTML fragment
content</span>.<!-- de facto standard -->

<p>An <code>encoded</code> <span>element</span> in the <span>RSS
content namespace</span> has an <span>HTML fragment
content</span>.<!-- Not explicitly defined in ths spec -->

<p>The <code>link</code> <span>element</span> in the <span>Atom
namespace</span> <em class=rfc2119>MAY</em> be inserted as
a <span>child</span> of a <code>channel</code> <span>element</span> in
the <span>RSS namespace</span>.<!-- no spec but sometimes used in the
wild -->

</section>

<section>
<h1>RSS2 elements</h1>

<p class=section-info><em>This section is only applied
to <span title="user agent">user agents</span>
<span title="supported
namespace">supporting</span> <span>RSS2</span>.</em>

<p>An <span>element</span> is an <dfn>RSS2 element</dfn> if and only
if it is in no namespace and either it is the <span>document
element</span> and its <span>local name</span> is <code>rss</code> or
one of its <span>ancestor</span> is an <span>RSS2 element</span>.

<div class="note memo">

<p>In other words, <span>elements</span> in no
namespace are <span>RSS2 element</span> if they belong to the main
document tree whose <span>document element</span> is the
<code>rss</code> element in no namespace.

</div>

<p><span title="RSS2 element">RSS2 elements</span> are interpreted as
described by RSS2 specifications <cite class="bibref normative">[<a
href="#ref-RSS2">RSS2</a>]</cite> <cite class="bibref normative">[<a
href="#ref-RSSPROFILE">RSSPROFILE</a>]</cite>.

<p>The <dfn>Media RSS namespace</dfn>
is <code>http://search.yahoo.com/mrss/</code>
or <code>http://search.yahoo.com/mrss</code>.

</section>

<section>
<h1>Atom elements</h1>

<p class=section-info><em>This section is only applied
to <span title="user agent">user agents</span>
<span title="supported
namespace">supporting</span> <span>Atom</span>.</em>

<p>Atom and its extension specifications allow extensions such that
almost everything is allowed, which is not useful
for <span title=validator>validators</span>.  This specification
defines stricter restrictions for the purpose
of <span title=validate>validation</span>.

<p>The <dfn>Atom namespace</dfn>
is <a href="https://tools.ietf.org/html/rfc4287"><code>http://www.w3.org/2005/Atom</code></a>.

<p>The <dfn>Atom 0.3 namespace</dfn>
is <a href="https://github.com/mnot/I-D/blob/gh-pages/Published/atom-format/draft-nottingham-atom-format-02.xml"><code>http://purl.org/atom/ns#</code></a>.

<p><dfn>Atom family namespaces</dfn> are
the <span>Atom 0.3 namespace</span>,
the <span>Atom namespace</span>,
<a href="https://tools.ietf.org/html/rfc4685"><code>http://purl.org/syndication/thread/1.0</code></a>,
<a href="https://tools.ietf.org/html/rfc5005"><code>http://purl.org/syndication/history/1.0</code></a>,
<a href="https://tools.ietf.org/html/rfc5023"><code>http://www.w3.org/2007/app</code></a>,
and
<a href="https://tools.ietf.org/html/rfc6721"><code>http://purl.org/atompub/tombstones/1.0</code></a>.
<!--
and Dublin Core namespace, Media RSS namespace
-->

<p>An <dfn>Atom family element</dfn> is an <span>element</span> in one
of <span>Atom family namespaces</span>.

<p>The term <dfn>Date construct</dfn> is defined by <a
href="http://tools.ietf.org/html/rfc4287">Atom 1.0 specification</a>.

<hr>

<p>Constraints expressed in RELAX NG schema fragments in an <span
title="applicable specification">applicable specifications</span> for
<span>Atom family namespaces</span> are to be interpreted as <em
class=rfc2119>MUST</em>-level requirements for the purpose of
<span title=validate>validation</span>.

<p><span title=comment>Comments</span>, <span title="inter-element
whitespace">inter-element whitespaces</span>, and
<span title="processing instruction">processing
instructions</span> <em class=rfc2119>MAY</em> be inserted anywhere in
an <span>Atom family element</span>.

<p>For an <span>Atom family element</span>, an <span>attribute</span>
or <span>child</span> that is not explicitly allowed by
an <span>applicable specification</span> <em class=rfc2119>MUST
NOT</em> be used.

<p>An <span>unknown namespace
element</span> <em class=rfc2119>MAY</em> be used as
a <span title=child>child</span> of <dfn title="Atom extensible
element">Atom extensible elements</dfn>,
i.e. following <span title=element>elements</span>:

  <ul>

  <li><span title="Atom family element">Atom family elements</span>
  which allow <span title="extension element">extension
  elements</span>, <code>extensionElement</code>,
  or <code>extensionSansTitleElement</code> in <span>content</span>

  <li><code>deleted-entry</code> <span title=element>elements</span>
  in <span>namespace</span> <code>http://purl.org/atompub/tombstones/1.0</code>

  <li><code>feed</code> <span title=element>elements</span> in
  the <span>Atom 0.3 namespace</span>

  <li><code>entry</code> <span title=element>elements</span> in
  the <span>Atom 0.3 namespace</span>

  </ul>

<p><span title=element>Elements</span> <code>complete</code>
and <code>archive</code>
in <span>namespace</span> <code>http://purl.org/syndication/history/1.0</code> <em class=rfc2119>MUST
NOT</em> be used more than once in
a <code>feed</code> <span>element</span> in the <span>Atom
namespace</span>.

<p>A <code>content</code> <span>element</span> in the <span>Atom 0.3
namespace</span> which has a <code>type</code> <span>attribute</span>
whose <span title="attribute value">value</span>
is <code>text/html</code> (<span>ASCII case-insensitive</span>) has
an <span>HTML fragment content</span>.<!-- Not explicitly defined in
ths spec -->


<p class=XXX>need to define &lt;atom:content> content validation when
type is a MIME type

<hr>

<p>The <code>group</code>
and <code>thumbnail</code> <span>element</span> in the <span>Media RSS
namespace</span> <em class=rfc2119>MAY</em> be inserted as
a <span>child</span> of an <code>entry</code> <span>element</span> in
the <span>Atom namespace</span>.<!-- no spec but sometimes used in the
wild -->

<!--
dc:subject is redundant with atom:category
<p>The <code>subject</code> <span>element</span> in the <span>Dublin
Core namespace</span> <em class=rfc2119>MAY</em> be inserted as
a <span>child</span> of an <code>entry</code> <span>element</span> in
the <span>Atom namespace</span>.< !-- no spec but sometimes used in the
wild -->

</section>

</section>

<section>
<h1>Validation of OGP</h1>

<p>A <code>meta</code> <span>element</span> in the <span>HTML
namespace</span> <em class=rfc2119>MAY</em> have
a <dfn title=attr-meta-property><code>property</code></dfn> <span>attribute</span>.
If the attribute is specified, the element <em class=rfc2119>MUST
NOT</em> have a <code title=attr-meta-name>name</code> attribute or an
attribute that cannot be used when
a <code title=attr-meta-name>name</code> attribute is specified.
The <code title=attr-meta-content>content</code>
attribute <em class=rfc2119>MUST</em> be specified if
a <code title=attr-meta-property>property</code> attribute is
specified.  An HTML <code>meta</code> element
with <code title=attr-meta-property>property</code> attribute
is <span>metadata content</span> (it is not a <span>phrasing
content</span>).

<p>The value of a <code title=attr-meta-property>property</code>
attribute <em class=rfc2119>MUST</em> be an <span>OGP property
name</span>.  A <dfn>OGP property name</dfn> is a <code
title=attr-meta-property>property</code> value defined by an
<span>applicable specification</span> or a <span>prefixed property
value</span>.  A <dfn>prefixed property value</dfn> is a
<span>property prefix</span> followed by a <code>U+003A</code> <code
class=charname>COLON</code> character (<code>:</code>) followed by one
or more characters.  A <dfn>property prefix</dfn> is a string of one
or more characters that is not a <code>U+003A</code> <code
class=charname>COLON</code> character (<code>:</code>) and is not used
by <code title=attr-meta-property>property</code> value defined by an
<span>applicable specification</span> as prefix.  A <i>deprecated</i>
<code title=attr-meta-property>property</code> value <em
class=rfc2119>SHOULD NOT</em> be used.

<p>A <code title=attr-meta-property>property</code> value <em
class=rfc2119>MUST NOT</em> be used unless it is defined in the
context it is used by an <span>applicable specification</span>.

  <div class="note memo">

  <p>Many <code title=attr-meta-property>property</code> values are
  only defined for speciic <code>og:type</code> values.

  </div>

<p>If the <code title=attr-meta-property>property</code> attribute
value is <dfn><code>og:type</code></dfn>, the <code
title=attr-meta-content>content</code> attribute value <em
class=rfc2119>MUST</em> be a value allowed as an <code>og:type</code>
value or a <span>prefixed property value</span>.

  <div class="note memo">

  <p>An example of <span title="applicable specification">applicable
  specifications</span> is <a href="http://ogp.me/"><cite>The Open
  Graph protocol</cite></a>.

  </div>

</section>


<section>
<h1>Data type validation</h1>

<p>This section defines how to interpret old unmaintained
specifications for the purpose
of <span title=validate>validation</span>.

<p>When an <span>element</span>'s <span>content</span> or
an <span>attribute</span> is defined to be one of the following
constructs, the <span>element</span>'s <span>child text content</span>
or the <span>attribute value</span> <em class=rfc2119>MUST</em> be
conform to the corresponding consturct instead:

  <dl class=switch>

  <dt>An RFC 3066 language tag
  <dd>A <span>valid language tag</span>.
  <!-- Atom family -->

  <dt>A URL (without referencing the
  latest <a href="http://url.spec.whatwg.org/"><cite>URL
  Standard</cite></a>)
  <dt>A URI
  <dt>An IRI
  <dt>An IRI reference
  <dd>A <span>valid URL</span>. (If IRI and IRI reference are
  distinguished, a <span>valid absolute URL</span> and a <span>valid
  URL</span>, respectively.)
  <!-- rdf:about, rdf:resource, link, url, hatena:imageurl,
  hatena:imageurlsmall, Atom family -->

  <dt>A media type
  <dt>A MIME media type
  <dd>A <span>valid MIME type</span>.
  <!-- Atom family -->

  <dt>An <code>addr-spec</code>
  <dt>An e-mail address
  <dd>A <span>valid e-mail address</span>.
  <!-- Atom family -->

  <dt>HTML markup<!-- content:encoded, hatena:formatted-content -->
  <dt>An HTML 4.01 markup that <em class=rfc2119>SHOULD</em> be such
  that it could validly appear directly within an
  HTML <code>div</code> element<!-- Atom type=html -->
  <dd>An <span>HTML fragment content</span>.

  <!--
  <dt>A W3C Date-Time string
  <dt>A W3CDTF
  <dd>As is.
  dc:date, Atom family
  -->

  </dl>

<p>When an <span>element</span> has to be an XHTML Modularization
<code>div</code> <span>element</span> that
<em class=rfc2119>SHOULD</em> be suitable for handling as XHTML,
it <em class=rfc2119>MUST</em> be
a <code>div</code> <span>element</span> in the <span>HTML
namespace</span><!-- and the requirements for it in
any <span>applicable specification</span> is applied-->.<!-- Atom
type=xhtml -->

<p>When an <span>element</span> has
<dfn>HTML fragment content</dfn>, setting its <span>child text
content</span> to a new
<code>div</code> <span>element</span> in the <span>HTML
namespace</span> <em class=rfc2119>MUST NOT</em> generate
a <span>parse error</span> or create a
non-conforming <span>tree</span>.

</section>

<section>
<h1>Data</h1>

<p class=section-info><em>This section is non-normative.</em>

<p>The <a
href="https://github.com/manakai/data-web-defs/">data-web-defs</a>
repository contains some machine-readable data for definitions in this
specification.

<p>The tests-web repository contains <a
href="https://github.com/wakaba/tests-web/tree/master/xml/validation">conformance
checking test data</a>.

</section>

<section class="reference normative">
<h2 class=no-num>References</h2>

<dl>

<dt id=ref-RSS2>RSS2
<dd><a href="http://www.rssboard.org/rss-specification"><cite>RSS 2.0</cite></a>, RSS Advisory Board.

<dt id=ref-RSSPROFILE>RSSPROFILE
<dd><a href="http://www.rssboard.org/rss-profile"><cite>Really Simple Syndication Best Practices Profile</cite></a>, RSS Advisory Board.

</dl>

</section>


<section>
<h1 class=no-num id=author>Author</h1>

<p>This document is written by
<a href=https://suika.suikawiki.org/~wakaba/who?>Wakaba</a>
&lt;wakaba@suikawiki.org&gt;.

<p>This document is developed as part of the
<a href=https://manakai.github.io/>the manakai project</a>.

<p>Per
<a href=https://creativecommons.org/publicdomain/zero/1.0/>CC0</a>, to
the extent possible under law, the author has waived all copyright and
related or neighboring rights to this work.

</section>
